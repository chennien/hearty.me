"use strict";function hj_update(d){return $.ajax({url:location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:d,async:!0,xhrFields:{withCredentials:!0}})}function update(d){if(!navigator.onLine)return!1;var r=$.ajax({url:location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:d,async:!1,xhrFields:{withCredentials:!0},success:function(a){return $(a).selector}});return(r.status>=200&&r.status<300||304==r.status)&&JSON.parse(r.responseText)}function is_touch_device(){return("ontouchstart"in window||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0)&&!matchMedia("(pointer:fine)").matches}function check_OS(os){var u=navigator.userAgent||"",d=/iP(ad|hone|od)|watchOS/i.test(u)?["iOS"]:u.match(/Windows|Macintosh|Android|Linux/gi)||[];return"Macintosh"==(d=d.length>0?d.slice(-1)[0]:"")&&is_touch_device()&&(d="iOS"),null==os?d:os==d}function check_browser(browser){var u=navigator.userAgent||"",b=/^((?!chrome|android).)*safari|Hearty_(iOS|macOS)/i.test(u)?["Safari"]:u.match(/(HuaWei|Ya|UC|QQ|BIDU|LB|Oppo|Miui|Vivo)browser|MetaSr|Maxthon|Edg(e|)|Opera(| Mini)|OPR|Firefox|Chrom(e|ium)|Trident|MSIE/gi)||[];return b=b.length>0?b[b.length-1]:"",null==browser?b:browser==b}function check_hjapp(app){var a=(navigator.userAgent||"").match(/Hearty_(iOS|Android|macOS)/)||[];return a=a.length>0&&a[0].replace(/Hearty_/i,""),null==app?a:app==a}function check_hjpwa(){return matchMedia("(display-mode:standalone)").matches}function hj_getScript(url,onsuccess,onerror,attrs){return $.ajax({type:"GET",dataType:"script",url:url,success:onsuccess||{},error:onerror||{},cache:!0,scriptCharset:"utf-8",attrs:attrs||{}})}function hj_getScript_npm(path,onsuccess,onerror){return onerror=onerror||{},hj_getScript("//cdn.jsdelivr.net/npm/"+(path=path||"jquery@3.6.1/dist/jquery.min.js"),onsuccess=onsuccess||{},function(){return hj_getScript("//unpkg.com/"+path,onsuccess,onerror)})}function hj_getScript_gh(p,onsuccess,onerror){return(p=p||{}).repo="repo"in p?p.repo:"chennien/hearty.me",p.path="path"in p?p.path:"",p.commit="commit"in p?p.commit:"4",onsuccess=onsuccess||{},onerror=onerror||{},hj_getScript("//cdn.jsdelivr.net/gh/"+p.repo+"@"+p.commit+"/"+p.path,onsuccess,function(){return hj_getScript("//cdn.statically.io/gh/"+p.repo+"/"+p.commit+"/"+p.path,onsuccess,onerror)})}function hj_getFile(url,filename,callback){if("fetch"in window)return alertify.success('<i class="fas fa-arrow-alt-to-bottom"></i> '+(filename||_h("h-downloading"))),hj_loading(),fetch("//"+url,{method:"GET",mode:"cors",cache:"force-cache",redirect:"error"}).then(function(a){if(!a.ok)throw new Error;return a.blob()}).then(function(b){var a=(window.URL||window.webkitURL).createObjectURL(b);$("<a>",{href:a,download:decodeURIComponent(filename||url.split("/").slice(-1)[0]||"")}).get(0).click(),(window.URL||window.webkitURL).revokeObjectURL(a),hj_loading(!1),"function"==typeof callback&&callback()}).catch(function(){open_url("//"+url),hj_loading(!1)});open_url("//"+url)}function hj_jsdelivr(){return"//cdn.jsdelivr.net/gh/chennien/hearty.me@4/"}function _h_init(){"object"==typeof _h$&&$("[data-h]").length>0&&$("body *,title").each(function(){let b=Object.assign({},$(this).get(0).dataset);for(var a in b)if("h"==a){let f=_h(b[a]).replace(/\n/g,"");$(this).is("title")?$(this).text(f):$(this).prepend(_h(b[a]).replace(/\n/g,"<br>")).attr({title:f}),$(this).removeAttr("data-h")}else if("h_date"==a){let c=b[a];c=c?date_format(b[a],!0):"",$(this).attr({"data-date":c,title:c}).removeAttr("data-"+a)}else if(a.startsWith("h_")){let e=_h(b[a]),d={};"title"==(a=a.substr(2))&&($(this).is("input,textarea,[contenteditable]")?d.placeholder=e:$(this).is("img")&&(d.alt=e)),d[0>["title","href","src","download"].indexOf(a)?"data-"+a:a]=e,$(this).attr(d).removeAttr("data-h_"+a)}})}function _h(k,x){if(k=(k||"").toString().split("-"),!(window._h$&&k.length>1&&k[0]in _h$)||!(k[1]in _h$[k[0]]))return k[0]&&(k="("+k.join("-")+")",console.warn("_h$"+k+" is missing")),k;{let v=_h$[k[0]][k[1]][k[2]];if(null==v&&(v=_h$[k[0]][k[1]]||""),"object"==typeof x)for(let i in x)v=v.replace(i,x[i]);return v}}function check_hostname(){if(top.location.hostname.split(".").splice(-2).join(".")!=self.location.hostname.split(".").splice(-2).join("."))top.location.href=self.location.href;else if("hearty.me"!=location.hostname){var u=location.href.replace(location.hostname,"hearty.me");$(function(){msg('<h3><i class="far fa-wrench"></i> Testing Purposes Only</h3><i class="fab fa-cloudflare"></i> "<u>'+location.hostname+'</u>" is used to demonstrate a known bug, please use the service on our primary domain: <u>hearty.me</u> to prevent issues.',"Back",function(){top.location.href=u})}),setTimeout(function(){top.location.href=u},1e4)}}function cssFeatureSupported(prop,value){if("CSS"in window)return CSS.supports(prop,value);var d=document.createElement("div");return d.style[prop]=value,d.style[prop]==value}function getUrlPara(para){var reg=new RegExp("(^|&)"+para+"=([^&]*)(&|$)"),r=location.search.substr(1).match(reg);return null!=r?decodeURIComponent(r[2]):null}function getcookie(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){var c=ca[i].trim();if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""}function setcookie(cname,val,days_added){void 0===val&&(val="");var d=new Date;d.setDate(d.getDate()+(days_added||1)),document.cookie=(cname||"")+"="+val+";expires="+d.toGMTString()+";domain=."+document.domain+";path=/;samesite=lax;secure"}function hj_alert(t){alert(t)}function hj_vibrate(s){var v="vibrate"in navigator;return v&&navigator.vibrate([s||80]),v}function open_url(l){check_hjapp("Android")?location.href=l+(l.indexOf("?")>0?"&":"?")+"wvtab=1":window.open(l,"_blank")}function account_status(){return hj_update({action:"account_status"})}function msg(txt,btn,callback){txt=(txt||"").toString(),btn=btn||_h("h-ok"),callback=callback||function(){},$(".alertify-cover:visible").length>0?$.wait(1500).then(function(){msg(txt,btn,callback)}):(alertify.set({labels:{ok:btn}}),alertify.alert(txt||'<i class="far fa-info-circle"></i> '+_h("h-err"),callback))}function alertify_input_custom(a,c){var $a=$("#alertify .alertify-text");return null!=a&&"object"==typeof a&&("password"==a.type&&$a.wrap("<form></form>"),"autocomplete"in a||(a.autocomplete="off"),"autocapitalize"in a||(a.autocapitalize="off"),a.required="",$a.attr(a)),null!=c&&"object"==typeof c&&$a.css(c),$a}function alertify_input_shake(){return shake($("#alertify .alertify-text"))}function press_enter(e,action){(e.keyCode?e.keyCode:e.which)==13&&(action.indexOf("(")>0?eval(action):eval(action+"();"))}function url_shortener(path,is_short,title,img,desc){path=(path||"").replace(location.origin+"/","");var host="https://hearty.me/",utm="utm_source=hj.rs&utm_medium=hj.rs&utm_campaign=hj.rs",uri=path+(0>path.indexOf("?")?"?":"&")+utm,url=encodeURIComponent(host+uri);return uri=encodeURIComponent(uri),title=encodeURIComponent(title||document.title),img=encodeURIComponent(img||"https://i.hearty.app/i/illustrations/sheara.jpg?o=1"),desc=encodeURIComponent(desc||"\u6EAB\u5EA6\u65E5\u8A18 Hearty Journal\uFF1A"+host+path),$.ajax({url:"//hj.rs/_/get",type:"POST",crossDomain:!0,async:!0,headers:{Accept:"application/json"},contentType:"application/json",dataType:"json",data:JSON.stringify({suffix:{option:is_short?"SHORT":"UNGUESSABLE"},longDynamicLink:"https://app.hj.rs/?link="+host+"wv?p%3D"+uri+"&apn=com.hearty.me&amv=57&afl="+url+"&ibi=com.hearty.me&isi=1423459636&ifl="+url+"&st="+title+"&sd="+desc+"&si="+img+"&at=1010lPJU&ct=hj.rs&mt=8&pt=119194312&ofl="+url+"&"+utm})}).then(function(a){if(!("shortLink"in a))return!1;{let b=(a.shortLink||"").split("/").slice(-1).toString();return hj_update({action:"gform_post",uri:"1FAIpQLSdSBwn2jYQoGxa4_IavoY_PTzhEN-j7drarxHa9lYQSDNKVdQ",data:$.param({"entry.1179854838":"[hj_user_id]","entry.1215682547":"[hj_username]",emailAddress:"[hj_email]","entry.1786867398":"https://hj.rs/"+b,"entry.596740612":host+path,"entry.1965404500":check_browser()+", "+check_OS(),"entry.178006682":new Date().toISOString().split("T")[0]})}),b}})}function get_qrcode($qr,url,fn){if($qr=$qr||$(".qrcode"),"QRCode"in window){let icon="//i.hearty.app/b/images/qrcode.icon.png?o=1";new QRCode($qr.html("").get(0),{text:url||location.href.replace("//hearty.me","//hearty.app"),width:180,height:180,dotScale:.8,colorDark:"#555",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.H,logo:icon,backgroundImage:icon,backgroundImageAlpha:.1,PO:"#a78d8d",PI:"#bdaaaa",AO:"#bdaaaa",AI:"#a78d8d",crossOrigin:"anonymous",onRenderingEnd:function(b,a){$qr.attr({href:a,download:fn||_h("h-qr"),title:_h("h-qr")}).slideDown().css({cursor:"s-resize"})}})}else hj_getScript_gh({repo:"ushelp/EasyQRCodeJS",path:"dist/easy.qrcode.min.js",commit:"4.4.12"},function(){get_qrcode($qr,url,fn)})}function timestamping(){return Date.now?Date.now()/1e3|0:new Date().getTime()}function date_format(d,inclue_year){d=d?isNaN(d)?new Date(d):new Date(1e3*parseInt(d)):new Date;var opt={month:"short",day:"numeric"};return inclue_year&&(opt.year="numeric"),d.toLocaleDateString(hj_lang(),opt)}function dynamic_function(fn){this[fn].apply(null,Array.prototype.slice.call(arguments,1))}function htmlspecialchars(str){return str?str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function htmlDecode(i){return $("<i>").html(i||"").text()}function shake($e){for(var l=20,i=0;i<8;i++)$e.animate({"margin-left":"+="+(l=-l)+"px","margin-right":"-="+l+"px"},50);return hj_vibrate(100),$e}function nth(n){return[,"st","nd","rd"][n/10%10^1&&n%10]||"th"}function leave_InAppBrowser(){var o=getUrlPara("openExternalBrowser");if((navigator.userAgent||"").indexOf("Line/")>0&&!o){var u=location.href;location.href=u+(u.indexOf("?")>0?"&":"?")+"openExternalBrowser=1"}else if(o)try{var u=new URL(location);u.searchParams.delete("openExternalBrowser"),"function"==typeof history.replaceState&&history.replaceState({},document.title,u.pathname+u.search)}catch(e){}}function numberWithCommas(x){return(x||"").toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")||"0"}function capitalizeFirstLetter(str){return null==str?"":str.charAt(0).toUpperCase()+str.slice(1)}function hj_mixpanel(e,p){e&&"undefined"!=typeof mixpanel&&(null==p?mixpanel.track(e):mixpanel.track(e,p))}function ga_event_push(v0,v1){if(v0){"undefined"!=typeof gtag&&gtag("event",v0,v1);try{window.hj_AnalyticsWebInterface?window.hj_AnalyticsWebInterface.logEvent(v0,JSON.stringify(v1)):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.hj_AnalyticsWebInterface?window.webkit.messageHandlers.hj_AnalyticsWebInterface.postMessage({command:"logEvent",name:v0,parameters:v1}):"undefined"!=typeof firebase&&"analytics"in firebase&&firebase.analytics().logEvent(v0,v1)}catch(e){}}}function fb_event_push(custom,v0,v1){v0&&"undefined"!=typeof fbq&&fbq("track"+(custom?"Custom":""),v0,v1)}function scroll2focused($e){($e=$e||$("body")).find("input").filter("[type='text'],[type='email'],[type='number'],[type='date'],[type='tel'],[type='url']").add($e.find("textarea")).focus(function(){$("html,body").animate({scrollTop:$(this).offset().top-$(window).innerHeight()/4+"px"},"fast")})}function hj_copy($e,t){if(!($e.length>0))return!1;select_input_text($e);var c=document.execCommand("Copy",!1,null);return c&&alertify.success('<i class="far fa-copy"></i> '+(t||_h("h-copy"))),$e.blur(),c}function hj_copy_text(t){t=t||"";var $e=$("[data-clipboard]");$e.length?$e.val(t):$e=$("<input>",{type:"text",value:t,"data-clipboard":""}).appendTo("body"),hj_copy($e.show()),$e.hide()}function select_input_text($e){$e.length>0&&($e.is("input")&&check_OS("iOS")?($e.get(0).focus(),$e.get(0).setSelectionRange(0,9999)):$e.select())}function ios_body_position_fix(){scrollTo(0,0)}function hj_lang(){return($("script[data-lang]").attr("data-lang")||navigator.language||"zh-TW").toLowerCase()}function hj_lang_zhcn(){return/zh-CN/i.test(navigator.language||"")}function hj_ip(alt){return $.ajax({type:"GET",url:(alt?"//ip.heartymail.com":location.origin)+"/cdn-cgi/trace",async:!0,crossDomain:!0,dataType:"text"}).then(function(a){try{return a=(a||"").replace(/[\r\n]+/g,'","').replace(/\=+/g,'":"'),a=JSON.parse('{"'+a.slice(0,a.lastIndexOf('","'))+'"}')}catch(b){return hj_ip_alt()}}).fail(function(){return hj_ip_alt()})}function hj_ip_alt(alt){return $.ajax({type:"GET",url:"//"+(alt?"myexternalip.com/json":"ip.heartymail.com"),async:!0,crossDomain:!0,dataType:"json"}).then(function(a){return(a.ip||"").split(",")[0].trim()}).then(function(a){return $.ajax({type:"GET",url:"//api.hearty.app/ip/"+a,crossDomain:!0,async:!0,dataType:"json"}).then(function(b){return{ip:a,loc:b.countryCode||""}})})}function hj_localize_cn(){var sc=/zh-(CN|SG|MY)/i.test(hj_lang());return sc&&hj_getScript_gh({path:"public/editor.zhongwen.min.js"},function(){"function"==typeof zh_translatePage&&zh_translatePage(),hj_mixpanel("zhSC"),ga_event_push("zhSC")}),sc}function hj_rate(){check_OS("Android")?(alertify.set({labels:{ok:"\u{1F615}\u3000"+_h("h-satisfy-2"),cancel:"\u{1F618}\u3000"+_h("h-satisfy-1")},buttonReverse:!0}),alertify.confirm("\u{1F495} "+_h("h-satisfy-0"),function(a){a?open_url("//bitly.com/3H9iHLl"):hj_rating()}),setcookie("hearty_rated",1,30)):hj_rating()}function hj_rating(param){var t=_h("h-rate-0")+'<br><i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i>';if(null==param){var r={Google:['<i class="fab fa-google"></i> Google',"//hearty.me/wv?o=bitly.com/2YRuw7z"],iOS:['<i class="fab fa-app-store"></i> App Store',"//hearty.me/wv?o=apps.apple.com/app/id1423459636?action%3Dwrite-review"],Android:['<i class="fab fa-google-play"></i> Android',"market://details?id=com.hearty.me&showAllReviews=true"]},a=((check_hjapp()||"").match(/iOS|Android/)||[])[0];is_touch_device()?a?(alertify.set({labels:{ok:r.Google[0],cancel:r[a][0]},buttonReverse:!0}),alertify.confirm(t+"<br><br>"+_h("h-rate-1"),function(a){a?(location.assign(r.Google[1]),hj_rating(r[a])):(location.assign(r[a][1]),hj_rating(r.Google))}),location.assign("//hearty.me/wv?r=rating")):open_url("//bitly.com/2YRuw7z"):(open_url("//goo.gl/kQ7KbC"),msg('<i class="fal fa-flower"></i> '+_h("h-rate-2"),_h("h-rate-3")+' <i class="fas fa-kiss-wink-heart"></i>')),setcookie("hearty_rated",1,30)}else msg(t,param[0],function(){location.assign(param[1])})}function get_app(os,cp){os=os||check_OS(),cp=cp||"topbar";var cn=hj_lang_zhcn(),dl={Android:{apk:"//cdn.jsdelivr.net/gh/chennien/d.hearty.app@6/android/Hearty%20Journal.apk",play:"//go.hearty.me/hj_android_"+cp,market:"market://details?id=com.hearty.me&showAllReviews=true"},iOS:"//apps.apple.com/"+(cn?"cn/":/zh/i.test(hj_lang())?"tw/":"")+"app/id1423459636?pt=119194312&at=1010lPJU&mt=8&ct="+cp,clip:"//bitly.com/3fAKTee",UWP:"//bitly.com/3ynmYFL"},is_Android=check_OS("Android"),fname=/zh/i.test(hj_lang())?"\u6EAB\u5EA6\u65E5\u8A18":"Hearty Journal";switch(os){case"Android":if(cn)alertify.set({labels:{ok:'<i class="fas fa-arrow-to-bottom"></i> \u4EE5 APK \u5B89\u88DD',cancel:'<i class="fab fa-google-play"></i> Google Play'},buttonReverse:!0}),alertify.confirm('<i class="fab fa-android"></i> \u5B89\u5353\u7248 App',function(a){open_url(dl.Android[a?"apk":"play"])});else if(!is_Android){open_url(dl.Android.play),get_app_events(os,cp);return}open_url(dl.Android.market),get_app_events(os,cp);break;case"iOS":open_url(dl.iOS),get_app_events(os,cp);break;case"Windows":var ua=navigator.userAgent||"",browser=check_browser(),ver="default",cpu=/(Win|WOW|x)64|ARM/i.test(ua)||!check_OS("Windows")?"":"/x86";"Chrome"==browser?ver="chrome":(ua.indexOf("Windows NT 1")>0||"Edg"==browser)&&(ver="edge"),hj_getFile("d.hearty.app/win/"+ver+"/2021"+cpu+"/Hearty%20Journal.exe",fname+".exe",function(){msg('<img src="//i.hearty.app/AhGZgWy.png">')}),get_app_events(os+" ("+browser+")",cp);break;case"Macintosh":hj_getFile("cdn.jsdelivr.net/gh/chennien/d.hearty.app@6/mac/Hearty%20Journal.dmg",fname+".dmg"),get_app_events("macOS",cp);break;case"UWP":open_url(dl.UWP);break;default:alertify.set({labels:{ok:'<i class="fab fa-android"></i> Android',cancel:'<i class="fab fa-apple"></i> iOS'},buttonReverse:!0}),alertify.confirm('<i class="fal fa-mobile"></i> '+_h("i-title-0")+" | App",function(a){a?cn?(alertify.set({labels:{ok:'<i class="fas fa-arrow-to-bottom"></i> \u4EE5 APK \u5B89\u88C5',cancel:'<i class="fab fa-google-play"></i> Google Play'},buttonReverse:!0}),alertify.confirm('<i class="fab fa-android"></i> \u5B89\u5353\u5E94\u7528\u7A0B\u5E8F',function(a){a?is_Android?open_url(dl.Android.apk):msg('<i class="fal fa-qrcode"></i> \u626B\u63CF\u4E8C\u7EF4\u7801\uFF0C\u4EE5\u4E0B\u8F7D APK\uFF1A<br><a target="_blank" href="'+dl.Android.apk+'"><img src="//i.hearty.app/bSpa73m.png" title="\u4E0B\u8F7D APK"></a>',"\u626B\u63CF\u4E86"):open_url(dl.Android.play)})):open_url(dl.Android.play):open_url(dl.iOS),get_app_events(a?"Android":"iOS",cp)})}}function get_app_events(os,cp){ga_event_push("Get App",{event_category:"Apps",event_label:os=os||""}),hj_mixpanel("Get App",{platform:os,campaign:cp||""})}function hj_firebase_init(){if(window.firebase&&(firebase.initializeApp({apiKey:"AIzaSyAfAW9Zrxe1p-7VGwvCFRVrogSfxLvfptU",authDomain:"hearty-me.firebaseapp.com",databaseURL:"https://hearty-me.firebaseio.com",projectId:"hearty-me",storageBucket:"hearty-me.appspot.com",messagingSenderId:"61745568427",appId:"1:61745568427:web:d7cc2cd1fdd72814b335ee",measurementId:"G-TY63VJYXKY"}),"analytics"in firebase&&firebase.analytics.isSupported().then(a=>{a&&firebase.analytics()}),!check_hjapp()&&firebase.messaging.isSupported())){var m=firebase.messaging();m.usePublicVapidKey("BJGwjWY6MviBp3gKYq8yjJ7LQT-TUBfWphAMmq3biKDqINUv1s6l_qkvyEqF27ox3sxOoJCO_B7VDFS2qtYqozk"),m.onMessage(b=>{var a=b.data;new Notification(a.title,{body:a.body,icon:a.badge})}),window.Notification&&"granted"==Notification.permission&&hj_fcm_init()}}function hj_fcm_init(onfinish){onfinish=onfinish||function(){},/iOS|Android/i.test(check_hjapp())?(location.assign("//hearty.me/wv?r=pushnotification"+(window.hj_username?"&username="+hj_username:"")),onfinish()):window.Notification&&window.firebase&&firebase.messaging.isSupported()?Notification.requestPermission().then(b=>{switch(b){case"granted":var a=firebase.messaging();a.getToken().then(a=>{a?hj_fcm_register(a,onfinish):onfinish()}).catch(a=>{onfinish()}),a.onTokenRefresh(()=>{a.getToken().then(a=>{hj_fcm_register(a,onfinish)}).catch(a=>{onfinish()})});break;case"denied":var c="hearty_notification_denied";getcookie(c)?onfinish():(alertify.set({labels:{ok:_h("h-notify-3"),cancel:'<i class="fas fa-toggle-on"></i> '+_h("h-notify-2")},buttonReverse:!0}),alertify.confirm('<i class="far fa-bell-slash"></i> '+_h("h-notify-0")+"<br>"+_h("h-notify-1")+' <i class="far fa-sad-tear"></i>',function(a){if(!a)switch(check_browser()){case"Safari":open_url("//support.apple.com/guide/safari/sfri40734/mac#ibrw95cba9bb");break;case"Firefox":open_url("//mzl.la/20jwSoU");break;default:open_url("//support.google.com/chrome/answer/3220216")}setcookie(c,1,1),onfinish()}),hj_mixpanel("Push Notification Deny"),ga_event_push("Push Notification Deny"));break;default:onfinish()}}):onfinish()}function hj_fcm_register(fcmtoken,onfinish){return console.log("FCMtoken: "+fcmtoken),hj_update({action:"fcm_register",fcmtoken:fcmtoken,on_mobile:+is_touch_device()}).then(onfinish)}function hj_loading(on){var $b=$("body");!1===on?$b.removeClass("loading"):$b.addClass("loading").delay(5e3).queue(function(){$(this).removeClass("loading").dequeue()})}function hj_href(url){window.stop(),hj_loading(),url=(0>(url=url||"d").indexOf("//")?location.origin+"/":"")+url,top.location.href=url}function hj_go_href(uri){hj_href("//go.hearty.me/"+uri)}function post_font(font_id){font_id=font_id||getcookie("hearty_post_font")||"";var fonts=["openhuninn","taipeisans","openhuninn","jinxuan","cream","wenkai","yozai","naikai","jasonwriting2","jasonwriting1","jasonwriting4","jasonwriting5","jasonwriting6","kurewa","nanifont","pop-gothic","genyo","huiwen","ipencrane","lisu","yankai","weibei","jasonwriting3","caramel","bakudai","wind","fist","lihsianti","oyeh","liao","drechi"];if(!font_id)return fonts;var font=fonts[font_id=parseInt(font_id)];return!!font&&($("body").attr("data-font",font),setcookie("hearty_post_font",font_id,90),_h("a-fonts-"+font_id))}function webp_profile_image(img){var uri="//i.hearty.app/u/";return img?(img=img.split("#"),webp_support()||(img[0]+="?o=1"),img[0]+=img[1]?"#"+img[1]:"",uri+img[0]):uri+"default.jpg"}function webp_fallback(){if(!webp_support()){$("img[src*='i.hearty.app']").each(function(){this.naturalWidth||$(this).attr({src:webp_downgrade($(this).attr("src"))}).on("error",function(){this.src.indexOf("i.hearty.app")>0&&(this.src=webp_downgrade(this.src))})});var $e=$("section,div,figure"),e=check_browser()+" WebP Fallback";["background-image","background"].forEach(function(a){$e.filter(function(){var b=$(this).css(a);return b.length>0&&b.indexOf("i.hearty.app")>0}).each(function(){$(this).css(a,webp_downgrade($(this).css(a)))})}),$e.filter("[style*='i.hearty.app']").each(function(){$(this).attr({style:webp_downgrade($(this).attr("style"))})}),ga_event_push(e),hj_mixpanel(e)}}function webp_support(){var bucket="hearty_webp",c=getcookie(bucket);return""==c?$("<img>",{src:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}).on("load",function(){setcookie(bucket,+($(this).get(0).naturalWidth>0),14)}).on("error",function(){setcookie(bucket,0,14)}).get(0).naturalWidth>0:1==c}function webp_downgrade(i){return(i||"").replace("i.hearty.app/w/","i0.wp.com/").replace(/i.hearty.app\/(\S+)\/(\S+)\.(jp(e|)g|gif|png)(?!(\?)o=1)/gi,"i.hearty.app/$1/$2.$3?o=1")}$.ajaxSetup({scriptCharset:"utf-8",cache:!0}),$.wait=function(a){var b=$.Deferred();return setTimeout(function(){b.resolve()},a),b},$(function(){_h_init(),hj_firebase_init(),webp_fallback()}),check_hostname()