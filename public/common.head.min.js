"use strict";function hj_update(t){return $.ajax({url:location.origin+"/update"+(window.hj_username?"?u="+hj_username:""),type:"post",crossDomain:!0,dataType:"json",data:t,async:!0})}function update(t){if(window.navigator.onLine){var e=$.ajax({url:location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:t,async:!1,success:function(t){return $(t).selector}});return(e.status>=200&&e.status<300||304===e.status)&&JSON.parse(e.responseText)}return!1}function is_touch_device(){return!((navigator.userAgent||"").indexOf("Edge/")>0)&&("ontouchstart"in window||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0)}function check_OS(t){var e=navigator.userAgent||"",n=/iP(ad|hone|od)/i.test(e)?["iOS"]:e.match(/Windows|Macintosh|Android|iP(ad|hone|od)/gi)||[];return n=n.length>0?n[0]:"",null==t?n:t==n}function check_browser(t){var e=navigator.userAgent||"",n=/^((?!chrome|android).)*safari|Hearty_iOS/i.test(e)?["Safari"]:e.match(/(Ya|UC|QQ|BIDU|LB)browser|MetaSr|Maxthon|Edge|Opera(| Mini)|OPR|Firefox|Chrom(e|ium)|MSIE/gi)||[];return n=n.length>0?n[0]:"",null==t?n:t==n}function check_hjapp(t){var e=(navigator.userAgent||"").match(/Hearty_(iOS|Android)/)||[];return e=e.length>0&&e[0].replace(/Hearty_/i,""),null==t?e:t==e}function check_hjpwa(){return window.matchMedia("(display-mode: standalone)").matches}function hj_getScript(t,e,n){return $.ajax({type:"GET",dataType:"script",url:t,success:e||{},error:n||{},cache:!0,scriptCharset:"utf-8"})}function hj_getScript_npm(t,e,n){n=n||{},hj_getScript("//cdn.jsdelivr.net/npm/"+(t=t||"jquery@3.4.1/dist/jquery.min.js"),e=e||{},function(){hj_getScript("//unpkg.com/"+t,e,n)})}function hj_getScript_gh(t,e,n){(t=t||{}).repo="repo"in t?t.repo:"chennien/hearty.me",t.path="path"in t?t.path:"",t.commit="commit"in t?t.commit:"master",e=e||{},n=n||{},hj_getScript("//cdn.jsdelivr.net/gh/"+t.repo+"@"+t.commit+"/"+t.path,e,function(){hj_getScript("//cachefly.jsdelivr.net/gh/"+t.repo+"@"+t.commit+"/"+t.path,e,function(){hj_getScript("//cdn.statically.io/gh/"+t.repo+"/"+t.commit+"/"+t.path,e,n)})})}function serverReachable(){if(window.navigator.onLine){var t=$.ajax({type:"HEAD",url:location.origin+"/update?"+(new Date).getTime().toString(16),async:!1}).status;return t>=200&&t<300||304===t}return!1}function hj__include(t,e){var n;"js"==t?(n=document.createElement("script")).src=e:((n=document.createElement("link")).rel="stylesheet",n.href=e);(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(n)}function cssFeatureSupported(t,e){if("CSS"in window)return window.CSS.supports(t,e);var n=document.createElement("div");return n.style[t]=e,n.style[t]===e}function getUrlPara(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=location.search.substr(1).match(e);return null!=n?decodeURIComponent(n[2]):null}function getcookie(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var a=n[i].trim();if(0===a.indexOf(e))return a.substring(e.length,a.length)}return""}function setcookie(t,e,n){var i=new Date;i.setMonth(i.getMonth()+(n||3)),document.cookie=t+"="+e+";expires="+i+";domain=."+document.domain+";path=/"}function hj_alert(t){alert(t)}function hj_vibrate(t){"vibrate"in navigator&&navigator.vibrate([t||80])}function open_url(t){check_hjapp("Android")?location.href=t+(t.indexOf("?")>0?"&":"?")+"wvtab=1":window.open(t,"_blank")}function account_status(){return hj_update({action:"account_status"})}function msg(t,e,n){t=(t||"").toString(),e=e||"çŸ¥é“äº†",n=n||function(){},$(".alertify-cover:visible").length>0?$.wait(1500).then(function(){msg(t,e,n)}):(alertify.set({labels:{ok:e}}),alertify.alert(t||"ç›®å‰ç¶²è·¯å‚³è¼¸å»¶é²ï¼Œè«‹ç¨å¾Œå†è©¦",n))}function alertify_input_custom(t,e){var n=$("#alertify .alertify-text");return null!=t&&"object"==typeof t&&("password"==t.type&&n.wrap("<form></form>"),"autocomplete"in t||(t.autocomplete="off"),"autocapitalize"in t||(t.autocapitalize="off"),t.required="",n.attr(t)),null!=e&&"object"==typeof e&&n.css(e),n}function alertify_input_shake(){return shake($("#alertify .alertify-text"))}function press_enter(e,action){13==(e.keyCode?e.keyCode:e.which)&&(action.indexOf("(")>0?eval(action):eval(action+"();"))}function timestamping(){return Date.now?Date.now()/1e3|0:(new Date).getTime()}function hj_localdate(t){var e="show_year"in t&&t.show_year,n="timestamp"in t&&t.timestamp||timestamping();if("is_string"in t&&t.is_string){var i={month:"long",day:"numeric"};return e&&(i.year="numeric"),new Date(1e3*parseInt(n)).toLocaleDateString("zh-TW",i)}var a=new Date(36e5*Math.ceil(parseInt(n)/3600)-6e4*(new Date).getTimezoneOffset()).toISOString().split("T")[0];return a=a.split("-"),e||a.shift(),a.join("/")}function dynamic_function(t){this[t].apply(null,Array.prototype.slice.call(arguments,1))}function htmlspecialchars(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function shake(t){for(var e=20,n=0;n<8;n++)t.animate({"margin-left":"+="+(e=-e)+"px","margin-right":"-="+e+"px"},50);return navigator.vibrate&&navigator.vibrate([800]),t}function signout(t){null==t?(alertify.set({labels:{ok:"å¦",cancel:"ç™»å‡º ğŸ”‘"},buttonReverse:!1}),alertify.confirm("ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ",function(t){t||(ga_event_push("Sign Out",{event_category:"Auth",event_label:"Sign Out"}),window.sessionStorage.clear(),setcookie("hearty_screenlock","",1),location.assign("//hearty.me/signout"))})):(window.sessionStorage.clear(),setcookie("hearty_screenlock","",1),location.assign("//hearty.me/signout"))}function leave_InAppBrowser(){var t=getUrlPara("openExternalBrowser");if((navigator.userAgent||"").indexOf("Line/")>0&&!t){var e=location.href;location.href=e+(e.indexOf("?")>0?"&":"?")+"openExternalBrowser=1"}else if(t)try{(e=new URL(location)).searchParams.delete("openExternalBrowser"),window.history.replaceState({},document.title,e.pathname+e.search)}catch(t){}}function numberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function capitalizeFirstLetter(t){return null==t?"":t.charAt(0).toUpperCase()+t.slice(1)}function user_country(){var t=getcookie("hearty_user_country");if(t)return decodeURIComponent(t)||"";hj_getScript_gh({repo:"vdurmont/userinfo-js",path:"dist/userinfo.min.js",commit:"1.1.1"},function(){"UserInfo"in window&&"getInfo"in window.UserInfo&&window.UserInfo.getInfo(function(t){var e=new Date;return e.setDate(e.getDate()+1),document.cookie="hearty_user_country="+t.country.code+";expires="+e+";domain=."+document.domain+";path=/",t.country.code})})}function hj_mixpanel(t,e){void 0!==window.mixpanel&&(null==e?window.mixpanel.track(t):window.mixpanel.track(t,e))}function ga_event_push(t,e){void 0!==window.gtag&&window.gtag("event",t,e)}function scroll2focused(t){(t=t||$("body")).find("input[type='text'], input[type='email'], input[type='number'], input[type='date'], input[type='tel'], input[type='url'], textarea").focus(function(){$("html, body").animate({scrollTop:$(this).offset().top-$(window).innerHeight()/4+"px"},"fast")})}function hj_survey(t,e,n){var i=(e||$("body")).find("[data-gform]"),a=[];if(i.filter("[required]").each(function(){var t=$(this).is("[name]")?i.filter($("[name='"+$(this).attr("name")+"']")):$(this),e=hj_survey_val(t);null!=e&&e.length||a.push({e:t,t:t.attr("title")||""})}),i.filter("[minlength]").each(function(){var t=$(this).val().length;t>0&&t<Number($(this).attr("minlength"))&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter("[maxlength]").each(function(){$(this).val().length>Number($(this).attr("maxlength"))&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter('[type="email"]').each(function(){(!/@/.test($(this).val())||$(this).val().length<6)&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter("[pattern]").each(function(){new RegExp($(this).attr("pattern")).test(hj_survey_val($(this)))||a.push({e:$(this),t:$(this).attr("title")||""})}),a.length>0)return shake(a[0].e),a[0].e.focus(),a[0].t;var r={};return i.each(function(){var t=hj_survey_val($(this).is("[name]")?i.filter($("[name='"+$(this).attr("name")+"']")):$(this));null!=t&&(r["entry."+$(this).attr("data-gform")]=t.trim())}),Object.keys(r).length>0&&hj_update({action:"gform_post",uri:t,data:$.param(r)}).then(function(t){"function"==typeof n&&n(t)}),!0}function hj_survey_val(t){return t.is('[type="checkbox"]')?t.map(function(){return $(this).filter(":checked").val()}).toArray().join(", "):t.is('[type="radio"]')?t.filter(":checked").val():t.val()}function ios_body_position_fix(){check_OS("iOS")&&window.scrollTo(0,0)}function img_cdn_fallback(t){if(null!=t)return t.replace(/i[0-3].wp.com/gi,"cdn.statically.io/img");$("img[src*='.wp.com/']").attr("onerror","this.onerror=null; this.src=img_cdn_fallback(this.src)")}function hj_lang_zhcn(){return"zh-cn"==(navigator.language||"").toLowerCase()}function hj_localize_cn(){var t=hj_lang_zhcn();return t&&hj_getScript_gh({path:"public/editor.zhongwen.min.js",commit:"1.0.16"},function(){"function"==typeof zh_translatePage&&zh_translatePage()}),t}function hj_rating(){var t='çµ¦æº«åº¦æ—¥è¨˜ 5é¡†å°æ˜Ÿæ˜Ÿ<br><i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i>',e={Google:['<i class="fab fa-google"></i> Google',"//hearty.me/wv?o=hj.rs/rate"],iOS:['<i class="fab fa-app-store"></i> AppStore',"//itunes.apple.com/app/id1423459636?action=write-review"],Android:['<i class="fab fa-google-play"></i> Android',"market://details?id=com.hearty.me"]},n=check_hjapp();n?(alertify.set({labels:{ok:e.Google[0],cancel:e[n][0]},buttonReverse:!0}),alertify.confirm(t+"<br><br>é‚€è«‹è«‹æ‚¨æ–¼é€™è£¡çµ¦è©•ï¼š",function(i){i?(location.assign(e.Google[1]),hj_rating_2nd(t,e[n])):(location.assign(e[n][1]),hj_rating_2nd(t,e.Google))}),check_hjapp("iOS")&&location.assign("//hearty.me/wv?r=rating")):open_url("//hj.rs/rate")}function hj_rating_2nd(t,e){msg(t,e[0],function(){location.assign(e[1])})}$.ajaxSetup({scriptCharset:"utf-8",cache:!0}),$.wait=function(t){var e=$.Deferred();return setTimeout(function(){e.resolve()},t),e};