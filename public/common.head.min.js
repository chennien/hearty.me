"use strict";function hj_update(t){return $.ajax({url:window.location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:t,async:!0})}function update(t){if(window.navigator.onLine){var e=$.ajax({url:window.location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:t,async:!1,success:function(t){return $(t).selector}});return(e.status>=200&&e.status<300||304===e.status)&&JSON.parse(e.responseText)}return!1}function is_touch_device(){return!((navigator.userAgent||"").indexOf("Edge/")>0)&&("ontouchstart"in window||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0)}function check_OS(t){var e=navigator.userAgent||"",n=/iP(ad|hone|od)/i.test(e)?["iOS"]:e.match(/Windows|Macintosh|Android|iPad|iPhone|iPod/gi)||[];return n=n.length>0?n[0]:"",null==t?n:t==n}function check_browser(t){var e=navigator.userAgent||"",n=/^((?!chrome|android).)*safari|Hearty_iOS/i.test(e)?["Safari"]:e.match(/YaBrowser|UCBrowser|QQBrowser|BIDUBrowser|LBBROWSER|MetaSr|Maxthon|Edge|Opera Mini|OPR|Firefox|Chrome|MSIE/gi)||[];return n=n.length>0?n[0]:"",null==t?n:t==n}function check_hjapp(t){var e=(navigator.userAgent||"").match(/Hearty_(iOS|Android)/)||[];return e=e.length>0&&e[0],null==t?e:t==e}function hj_getScript(t,e){return $.ajax({type:"GET",dataType:"script",url:t,success:e||{},cache:!0,scriptCharset:"utf-8"})}function serverReachable(){if(window.navigator.onLine){var t=$.ajax({type:"HEAD",url:window.location.origin+"/update?"+(new Date).getTime().toString(16),async:!1}).status;return t>=200&&t<300||304===t}return!1}function hj__include(t,e){var n;"js"==t?(n=document.createElement("script")).src=e:((n=document.createElement("link")).rel="stylesheet",n.href=e);(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(n)}function cssFeatureSupported(t,e){if("CSS"in window)return window.CSS.supports(t,e);var n=document.createElement("div");return n.style[t]=e,n.style[t]===e}function getUrlPara(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?decodeURIComponent(n[2]):null}function getcookie(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var a=n[i].trim();if(0===a.indexOf(e))return a.substring(e.length,a.length)}return""}function setcookie(t,e,n){var i=new Date;i.setMonth(i.getMonth()+(n||3)),document.cookie=t+"="+e+";expires="+i+";domain=."+document.domain+";path=/"}function hj_alert(t){alert(t)}function msg(t,e,n){n=n||function(){},alertify.set({labels:{ok:e||"知道了"}}),alertify.alert(t||"目前發生錯誤，請稍後再試。",n)}function press_enter(e,action){13==(e.keyCode?e.keyCode:e.which)&&(action.indexOf("(")>0?eval(action):eval(action+"();"))}function timestamping(){return Date.now?Date.now()/1e3|0:(new Date).getTime()}function dynamic_function(t){this[t].apply(null,Array.prototype.slice.call(arguments,1))}function htmlspecialchars(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function shake(t){for(var e=20,n=0;n<8;n++)t.animate({"margin-left":"+="+(e=-e)+"px","margin-right":"-="+e+"px"},50);navigator.vibrate&&navigator.vibrate([800])}function signout(t){null==t?(alertify.set({labels:{ok:"否",cancel:"登出 🔑"},buttonReverse:!1}),alertify.confirm("確定要登出嗎？",function(t){t||(ga_event_push("Sign Out",{event_category:"Auth",event_label:"Sign Out"}),window.sessionStorage.clear(),setcookie("hearty_screenlock","",1),window.location.assign("//hearty.me/signout"))})):(window.sessionStorage.clear(),setcookie("hearty_screenlock","",1),window.location.assign("//hearty.me/signout"))}function numberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function user_country(){var t=getcookie("hearty_user_country");if(t)return decodeURIComponent(t)||"";$.getScript("//cdn.jsdelivr.net/gh/vdurmont/userinfo-js@84277391efd5d08f58fdf9c3ad75bc88263c5c49/dist/userinfo.min.js",function(){"UserInfo"in window&&"getInfo"in window.UserInfo&&window.UserInfo.getInfo(function(t){var e=new Date;return e.setTime(e.getTime()+864e5),document.cookie="hearty_user_country="+t.country.code+";expires="+e+";domain=."+document.domain+";path=/",t.country.code})})}function hj_mixpanel(t,e){void 0!==window.mixpanel&&(null==e?window.mixpanel.track(t):window.mixpanel.track(t,e))}function ga_event_push(t,e){void 0!==window.gtag&&window.gtag("event",t,e)}function scroll2focused(t){(t=t||$("body")).find("input[type='text'], input[type='email'], input[type='number'], input[type='date'], input[type='tel'], input[type='url'], textarea").focus(function(){$("html, body").animate({scrollTop:$(this).offset().top-$(window).innerHeight()/4+"px"},"fast")})}function hj_survey(t,e,n){var i=(e||$("body")).find("[data-gform]"),a=[];if(i.filter("[required]").each(function(){var t=$(this).is("[name]")?i.filter($("[name='"+$(this).attr("name")+"']")):$(this),e=hj_survey_val(t);null!=e&&e.length||a.push({e:t,t:t.attr("title")||""})}),i.filter("[minlength]").each(function(){var t=$(this).val().length;t>0&&t<Number($(this).attr("minlength"))&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter("[maxlength]").each(function(){$(this).val().length>Number($(this).attr("maxlength"))&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter('[type="email"]').each(function(){(!/@/.test($(this).val())||$(this).val().length<6)&&a.push({e:$(this),t:$(this).attr("title")||""})}),i.filter("[pattern]").each(function(){new RegExp($(this).attr("pattern")).test(hj_survey_val($(this)))||a.push({e:$(this),t:$(this).attr("title")||""})}),a.length>0)return shake(a[0].e),a[0].e.focus(),a[0].t;var r={};return i.each(function(){var t=hj_survey_val($(this).is("[name]")?i.filter($("[name='"+$(this).attr("name")+"']")):$(this));null!=t&&(r["entry."+$(this).attr("data-gform")]=t.trim())}),Object.keys(r).length>0&&hj_update({action:"gform_post",uri:t,data:$.param(r)}).then(function(t){"function"==typeof n&&n(t)}),!0}function hj_survey_val(t){return t.is('[type="checkbox"]')?t.map(function(){return $(this).filter(":checked").val()}).toArray().join(", "):t.is('[type="radio"]')?t.filter(":checked").val():t.val()}$.ajaxSetup({scriptCharset:"utf-8",cache:!0});