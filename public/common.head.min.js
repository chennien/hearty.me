"use strict";function hj_update(e){return $.ajax({url:location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:e,async:!0,xhrFields:{withCredentials:!0}})}function update(e){if(navigator.onLine){var t=$.ajax({url:location.origin+"/update",type:"post",crossDomain:!0,dataType:"json",data:e,async:!1,xhrFields:{withCredentials:!0},success:function(e){return $(e).selector}});return(t.status>=200&&t.status<300||304==t.status)&&JSON.parse(t.responseText)}return!1}function is_touch_device(){return("ontouchstart"in window||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0)&&!matchMedia("(pointer:fine)").matches}function check_OS(e){var t=navigator.userAgent||"",a=/iP(ad|hone|od)|watchOS/i.test(t)?["iOS"]:t.match(/Windows|Macintosh|Android|Linux/gi)||[];return"Macintosh"==(a=a.length>0?a.slice(-1)[0]:"")&&is_touch_device()&&(a="iOS"),null==e?a:e==a}function check_browser(e){var t=navigator.userAgent||"",a=/^((?!chrome|android).)*safari|Hearty_iOS/i.test(t)?["Safari"]:t.match(/(HuaWei|Ya|UC|QQ|BIDU|LB|Oppo|Miui|Vivo)browser|MetaSr|Maxthon|Edg(e|)|Opera(| Mini)|OPR|Firefox|Chrom(e|ium)|Trident|MSIE/gi)||[];return a=a.length>0?a[a.length-1]:"",null==e?a:e==a}function check_hjapp(e){var t=(navigator.userAgent||"").match(/Hearty_(iOS|Android)/)||[];return t=t.length>0&&t[0].replace(/Hearty_/i,""),null==e?t:e==t}function check_hjpwa(){return matchMedia("(display-mode:standalone)").matches}function hj_getScript(e,t,a,n){return $.ajax({type:"GET",dataType:"script",url:e,success:t||{},error:a||{},cache:!0,scriptCharset:"utf-8",attrs:n||{}})}function hj_getScript_npm(e,t,a){return a=a||{},hj_getScript("//cdn.jsdelivr.net/npm/"+(e=e||"jquery@3.6/dist/jquery.min.js"),t=t||{},function(){return hj_getScript("//unpkg.com/"+e,t,a)})}function hj_getScript_gh(e,t,a){return(e=e||{}).repo="repo"in e?e.repo:"chennien/hearty.me",e.path="path"in e?e.path:"",e.commit="commit"in e?e.commit:"1.0.43",t=t||{},a=a||{},hj_getScript("//cdn.jsdelivr.net/gh/"+e.repo+"@"+e.commit+"/"+e.path,t,function(){return hj_getScript("//cdn.statically.io/gh/"+e.repo+"/"+e.commit+"/"+e.path,t,a)})}function hj_getFile(e,t,a){if("fetch"in window){alertify.success('<i class="fas fa-arrow-alt-to-bottom"></i> '+(t||_h("h-downloading")));var n=$("body").addClass("loading");return fetch("//"+e,{method:"GET",mode:"cors",cache:"force-cache",redirect:"error"}).then(function(e){if(!e.ok)throw new Error;return e.blob()}).then(function(i){var r=(window.URL||window.webkitURL).createObjectURL(i);$("<a>",{href:r,download:decodeURIComponent(t||e.split("/").slice(-1)[0]||"")}).get(0).click(),(window.URL||window.webkitURL).revokeObjectURL(r),n.removeClass("loading"),"function"==typeof a&&a()}).catch(function(){open_url("//"+e),n.removeClass("loading")})}open_url("//"+e)}function hj_jsdelivr(){return"//cdn.jsdelivr.net/gh/chennien/hearty.me@1.0.43/"}function _h_init(){"object"==typeof _h$&&$("[data-h]").length>0&&$("body *,title").each(function(){let e=Object.assign({},$(this).get(0).dataset);for(var t in e)if("h"==t){let a=_h(e[t]);$(this).is("title")?$(this).text(a):$(this).prepend(a).attr({title:a}),$(this).removeAttr("data-h")}else if(t.startsWith("h_")){let a=_h(e[t]),n={};switch(t=t.substr(2)){case"title":$(this).is("input,textarea,[contenteditable]")?n.placeholder=a:$(this).is("img")&&(n.alt=a);break;case"date":a=date_format(a,!0)}n[["title","href","src","download"].indexOf(t)<0?"data-"+t:t]=a,$(this).attr(n).removeAttr("data-h_"+t)}})}function _h(e,t){if(e=(e||"").toString().split("-"),window._h$&&e.length>1&&e[0]in _h$&&e[1]in _h$[e[0]]){let a=_h$[e[0]][e[1]][e[2]];if(null==a&&(a=_h$[e[0]][e[1]]||""),"object"==typeof t)for(let e in t)a=a.replace(e,t[e]);return a}return e[0]&&(e="("+e.join("-")+")",console.warn("_h$"+e+" is missing")),e}function check_hostname(){if(top.location.hostname.split(".").splice(-2).join(".")!=self.location.hostname.split(".").splice(-2).join("."))top.location.href=self.location.href;else if("hearty.me"!=location.hostname){var e=location.href.replace(location.hostname,"hearty.me");$(function(){msg('<h3><i class="far fa-wrench"></i> Testing Purposes Only</h3><i class="fab fa-cloudflare"></i> "<u>'+location.hostname+'</u>" is used to demonstrate a known bug, please use the service on our primary domain: <u>hearty.me</u> to prevent issues.',"Back",function(){top.location.href=e})}),setTimeout(function(){top.location.href=e},1e4)}}function cssFeatureSupported(e,t){if("CSS"in window)return CSS.supports(e,t);var a=document.createElement("div");return a.style[e]=t,a.style[e]==t}function getUrlPara(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=location.search.substr(1).match(t);return null!=a?decodeURIComponent(a[2]):null}function getcookie(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){var i=a[n].trim();if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}function setcookie(e,t,a){void 0===t&&(t="");var n=new Date;n.setDate(n.getDate()+(a||1)),document.cookie=(e||"")+"="+t+";expires="+n.toGMTString()+";domain=."+document.domain+";path=/;samesite=lax;secure"}function hj_alert(e){alert(e)}function hj_vibrate(e){var t="vibrate"in navigator;return t&&navigator.vibrate([e||80]),t}function open_url(e){check_hjapp("Android")?location.href=e+(e.indexOf("?")>0?"&":"?")+"wvtab=1":window.open(e,"_blank")}function account_status(){return hj_update({action:"account_status"})}function msg(e,t,a){e=(e||"").toString(),t=t||_h("h-ok"),a=a||function(){},$(".alertify-cover:visible").length>0?$.wait(1500).then(function(){msg(e,t,a)}):(alertify.set({labels:{ok:t}}),alertify.alert(e||'<i class="far fa-info-circle"></i> '+_h("h-err"),a))}function alertify_input_custom(e,t){var a=$("#alertify .alertify-text");return null!=e&&"object"==typeof e&&("password"==e.type&&a.wrap("<form></form>"),"autocomplete"in e||(e.autocomplete="off"),"autocapitalize"in e||(e.autocapitalize="off"),e.required="",a.attr(e)),null!=t&&"object"==typeof t&&a.css(t),a}function alertify_input_shake(){return shake($("#alertify .alertify-text"))}function press_enter(e,action){13==(e.keyCode?e.keyCode:e.which)&&(action.indexOf("(")>0?eval(action):eval(action+"();"))}function url_shortener(e,t,a,n,i){e=(e||"").replace(location.origin+"/","");var r="https://hearty.me/",o="utm_source=hj.rs&utm_medium=hj.rs&utm_campaign=hj.rs",s=e+(e.indexOf("?")<0?"?":"&")+o,c=encodeURIComponent(r+s);return s=encodeURIComponent(s),a=encodeURIComponent(a||document.title),n=encodeURIComponent(n||"https://i.hearty.app/i/illustrations/sheara.jpg?o=1"),i=encodeURIComponent(i||"Ê∫´Â∫¶Êó•Ë®ò Hearty JournalÔºö"+r+e),$.ajax({url:"//hj.rs/_/get",type:"POST",crossDomain:!0,async:!0,headers:{Accept:"application/json"},contentType:"application/json",dataType:"json",data:JSON.stringify({suffix:{option:t?"SHORT":"UNGUESSABLE"},longDynamicLink:"https://app.hj.rs/?link="+r+"wv?p%3D"+s+"&apn=com.hearty.me&amv=53&afl="+c+"&ibi=com.hearty.me&isi=1423459636&ifl="+c+"&st="+a+"&sd="+i+"&si="+n+"&at=1010lPJU&ct=hj.rs&mt=8&pt=119194312&ofl="+c+"&"+o})}).then(function(t){if("shortLink"in t){let a=(t.shortLink||"").split("/").slice(-1).toString();return hj_update({action:"gform_post",uri:"1FAIpQLSdSBwn2jYQoGxa4_IavoY_PTzhEN-j7drarxHa9lYQSDNKVdQ",data:$.param({"entry.1179854838":"[hj_user_id]","entry.1215682547":"[hj_username]",emailAddress:"[hj_email]","entry.1786867398":"https://hj.rs/"+a,"entry.596740612":r+e,"entry.1965404500":check_browser()+", "+check_OS(),"entry.178006682":(new Date).toISOString().split("T")[0]})}),a}return!1})}function get_qrcode(e,t,a){if(e=e||$(".qrcode"),"QRCode"in window){let n="//i.hearty.app/b/images/qrcode.icon.png?o=1";new QRCode(e.html("").get(0),{text:t||location.href.replace("//hearty.me","//hearty.app"),width:180,height:180,dotScale:.8,colorDark:"#555",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.H,logo:n,backgroundImage:n,backgroundImageAlpha:.1,PO:"#a78d8d",PI:"#bdaaaa",AO:"#bdaaaa",AI:"#a78d8d",crossOrigin:"anonymous",onRenderingEnd:function(t,n){e.attr({href:n,download:a||_h("h-qr"),title:_h("h-qr")}).slideDown().css({cursor:"s-resize"})}})}else hj_getScript_gh({repo:"ushelp/EasyQRCodeJS",path:"dist/easy.qrcode.min.js",commit:"4.4.6"},function(){get_qrcode(e,t,a)})}function timestamping(){return Date.now?Date.now()/1e3|0:(new Date).getTime()}function date_format(e,t){e=e?new Date(e):new Date;var a={month:"short",day:"numeric"};return t&&(a.year="numeric"),e.toLocaleDateString(navigator.language||"zh-TW",a)}function hj_localdate(e){console.warn("* fn hj_localdate is deprecated");var t="show_year"in e&&e.show_year,a="timestamp"in e&&e.timestamp||timestamping();if("is_string"in e&&e.is_string){var n={month:"long",day:"numeric"};return t&&(n.year="numeric"),new Date(1e3*parseInt(a)).toLocaleDateString("zh-TW",n)}var i=new Date(36e5*Math.ceil(parseInt(a)/3600)-6e4*(new Date).getTimezoneOffset()).toISOString().split("T")[0];return i=i.split("-"),t||i.shift(),i.join("/")}function dynamic_function(e){this[e].apply(null,Array.prototype.slice.call(arguments,1))}function htmlspecialchars(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}function htmlDecode(e){return $("<i>").html(e||"").text()}function shake(e){for(var t=20,a=0;a<8;a++)e.animate({"margin-left":"+="+(t=-t)+"px","margin-right":"-="+t+"px"},50);return hj_vibrate(100),e}function nth(e){return[,"st","nd","rd"][e/10%10^1&&e%10]||"th"}function leave_InAppBrowser(){var e=getUrlPara("openExternalBrowser");if((navigator.userAgent||"").indexOf("Line/")>0&&!e){var t=location.href;location.href=t+(t.indexOf("?")>0?"&":"?")+"openExternalBrowser=1"}else if(e)try{(t=new URL(location)).searchParams.delete("openExternalBrowser"),"function"==typeof history.replaceState&&history.replaceState({},document.title,t.pathname+t.search)}catch(e){}}function numberWithCommas(e){return(e||"").toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")||"0"}function capitalizeFirstLetter(e){return null==e?"":e.charAt(0).toUpperCase()+e.slice(1)}function hj_mixpanel(e,t){e&&"undefined"!=typeof mixpanel&&(null==t?mixpanel.track(e):mixpanel.track(e,t))}function ga_event_push(e,t){if(e){"undefined"!=typeof gtag&&gtag("event",e,t);try{window.hj_AnalyticsWebInterface?window.hj_AnalyticsWebInterface.logEvent(e,JSON.stringify(t)):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.hj_AnalyticsWebInterface?window.webkit.messageHandlers.hj_AnalyticsWebInterface.postMessage({command:"logEvent",name:e,parameters:t}):"undefined"!=typeof firebase&&"analytics"in firebase&&firebase.analytics().logEvent(e,t)}catch(e){}}}function fb_event_push(e,t,a){t&&"undefined"!=typeof fbq&&fbq("track"+(e?"Custom":""),t,a)}function scroll2focused(e){(e=e||$("body")).find("input").filter("[type='text'],[type='email'],[type='number'],[type='date'],[type='tel'],[type='url']").add(e.find("textarea")).focus(function(){$("html,body").animate({scrollTop:$(this).offset().top-$(window).innerHeight()/4+"px"},"fast")})}function hj_copy(e,t){if(e.length>0){select_input_text(e);var a=document.execCommand("Copy",!1,null);return a&&alertify.success('<i class="far fa-copy"></i> '+(t||_h("h-copy"))),e.blur(),a}return!1}function hj_copy_text(e){e=e||"";var t=$("[data-clipboard]");t.length?t.val(e):t=$("<input>",{type:"text",value:e,"data-clipboard":""}).appendTo("body"),hj_copy(t.show()),t.hide()}function select_input_text(e){e.length>0&&(e.is("input")&&check_OS("iOS")?(e.get(0).focus(),e.get(0).setSelectionRange(0,9999)):e.select())}function hj_survey(e,t,a){console.warn("* fn hj_survey is deprecated");var n=(t||$("body")).find("[data-gform]"),i=[];if(n.filter("[required]").each(function(){var e=$(this).is("[name]")?n.filter($("[name='"+$(this).attr("name")+"']")):$(this),t=hj_survey_val(e);null!=t&&t.length||i.push({e:e,t:e.attr("title")||""})}),n.filter("[minlength]").each(function(){var e=$(this).val().length;e>0&&e<Number($(this).attr("minlength"))&&i.push({e:$(this),t:$(this).attr("title")||""})}),n.filter("[maxlength]").each(function(){$(this).val().length>Number($(this).attr("maxlength"))&&i.push({e:$(this),t:$(this).attr("title")||""})}),n.filter('[type="email"]').each(function(){(!/@/.test($(this).val())||$(this).val().length<6)&&i.push({e:$(this),t:$(this).attr("title")||""})}),n.filter("[pattern]").each(function(){new RegExp($(this).attr("pattern")).test(hj_survey_val($(this)))||i.push({e:$(this),t:$(this).attr("title")||""})}),i.length>0)return shake(i[0].e),i[0].e.focus(),i[0].t;var r={};return n.each(function(){var e=hj_survey_val($(this).is("[name]")?n.filter($("[name='"+$(this).attr("name")+"']")):$(this));null!=e&&(r["entry."+$(this).attr("data-gform")]=e.trim())}),Object.keys(r).length>0&&hj_update({action:"gform_post",uri:e,data:$.param(r)}).then(function(e){"function"==typeof a&&a(e)}),!0}function hj_survey_val(e){return e.is("[type='checkbox']")?e.map(function(){return $(this).filter(":checked").val()}).toArray().join(", "):e.is("[type='radio']")?e.filter(":checked").val():e.val()}function ios_body_position_fix(){scrollTo(0,0)}function hj_lang_zhcn(){return(navigator.language||"").toLowerCase().indexOf("zh-cn")>=0}function hj_ip(e){return $.ajax({type:"GET",url:(e?"//cloudflare.net":location.origin)+"/cdn-cgi/trace",async:!0,crossDomain:!0,dataType:"text"}).then(function(e){try{return e=(e||"").replace(/[\r\n]+/g,'","').replace(/\=+/g,'":"'),e=$.parseJSON('{"'+e.slice(0,e.lastIndexOf('","'))+'"}')}catch(e){return hj_ip_alt()}}).fail(function(){return hj_ip_alt()})}function hj_ip_alt(e){return $.ajax({type:"GET",url:"//"+(e?"myexternalip.com/json":"hearty.me/ip"),async:!0,crossDomain:!0,dataType:"json"}).then(function(e){return e.ip||""}).then(function(e){return $.ajax({type:"GET",url:"//api.hearty.app/ip/"+e,crossDomain:!0,async:!0,dataType:"json"}).then(function(e){return{loc:e.countryCode||"",ip:e.query||""}})})}function hj_localize_cn(){var e=hj_lang_zhcn();return e&&hj_getScript_gh({path:"public/editor.zhongwen.min.js"},function(){"function"==typeof zh_translatePage&&zh_translatePage(),hj_mixpanel("zhCN"),ga_event_push("zhCN")}),e}function hj_rate(){check_OS("Android")?(alertify.set({labels:{ok:"üòï„ÄÄ"+_h("h-satisfy-2"),cancel:"üòò„ÄÄ"+_h("h-satisfy-1")},buttonReverse:!0}),alertify.confirm("üíï "+_h("h-satisfy-0"),function(e){e?open_url("//forms.gle/5XHN77w5PcqcXJfFA"):hj_rating()}),setcookie("hearty_rated",1,7)):hj_rating()}function hj_rating(e){var t=_h("h-rate-0")+'<br><i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i> <i class="fal fa-star"></i>';if(null==e){var a={Google:['<i class="fab fa-google"></i> Google',"//hearty.me/wv?o=bitly.com/2YRuw7z"],iOS:['<i class="fab fa-app-store"></i> App Store',"//hearty.me/wv?o=apps.apple.com/app/id1423459636?action=write-review"],Android:['<i class="fab fa-google-play"></i> Android',"market://details?id=com.hearty.me&showAllReviews=true"]},n=check_hjapp();is_touch_device()?n?(alertify.set({labels:{ok:a.Google[0],cancel:a[n][0]},buttonReverse:!0}),alertify.confirm(t+"<br><br>"+_h("h-rate-1"),function(e){e?(location.assign(a.Google[1]),hj_rating(a[n])):(location.assign(a[n][1]),hj_rating(a.Google))}),location.assign("//hearty.me/wv?r=rating")):open_url("//bitly.com/2YRuw7z"):(open_url("//goo.gl/kQ7KbC"),msg('<i class="fal fa-flower"></i> '+_h("h-rate-2"),_h("h-rate-3")+' <i class="fas fa-kiss-wink-heart"></i>')),setcookie("hearty_rated",1,7)}else msg(t,e[0],function(){location.assign(e[1])})}function get_app(e,t){e=e||check_OS(),t=t||"topbar";var a=hj_lang_zhcn(),n={Android:{apk:"//cdn.jsdelivr.net/gh/chennien/d.hearty.app@4/android/%E6%BA%AB%E5%BA%A6%E6%97%A5%E8%A8%98.apk",play:"//go.hearty.me/hj_android_"+t,market:"market://details?id=com.hearty.me&showAllReviews=true"},iOS:{store:"//apps.apple.com/app/id1423459636?pt=119194312&at=1010lPJU&mt=8&ct="+t,url:"//go.hearty.me/hj_ios_"+t},clip:"//bitly.com/3fAKTee",UWP:"//bitly.com/3ynmYFL"},i=check_OS("Android"),r=(navigator.language||"").toLowerCase().indexOf("zh")>=0?"Ê∫´Â∫¶Êó•Ë®ò":"Hearty Journal";switch(e){case"Android":if(a)alertify.set({labels:{ok:'<i class="fas fa-arrow-to-bottom"></i> ‰ª• APK ÂÆâË£ù',cancel:'<i class="fab fa-google-play"></i> Google Play'},buttonReverse:!0}),alertify.confirm('<i class="fab fa-android"></i> ÂÆâÂçìÁâà App',function(e){open_url(n.Android[e?"apk":"play"])});else if(!i)return open_url(n.Android.play),void get_app_events(e,t);open_url(n.Android.market),get_app_events(e,t);break;case"iOS":open_url(n.iOS[a?"store":"url"]),get_app_events(e,t);break;case"Windows":var o=navigator.userAgent||"",s=check_browser(),c="default",l=o.indexOf("Win64")>0||!check_OS("Windows")?"64":"86";"Chrome"==s?c="chrome":(o.indexOf("Windows NT 1")>0||"Edg"==s)&&(c="edge"),hj_getFile("d.hearty.app/win/"+c+".x"+l+"/%E6%BA%AB%E5%BA%A6%E6%97%A5%E8%A8%98.exe",r+".exe",function(){msg('<img src="//i.hearty.app/AhGZgWy.png">')}),get_app_events(e+" ("+s+")",t);break;case"Macintosh":hj_getFile("cdn.jsdelivr.net/gh/chennien/d.hearty.app@4/mac/%E6%BA%AB%E5%BA%A6%E6%97%A5%E8%A8%98.dmg",r+".dmg"),get_app_events("macOS",t);break;case"UWP":open_url(n.UWP);break;default:alertify.set({labels:{ok:'<i class="fab fa-android"></i> Android',cancel:'<i class="fab fa-apple"></i> iOS'},buttonReverse:!0}),alertify.confirm('<i class="fal fa-mobile"></i> '+_h("i-title-0")+" | App",function(e){e?a?(alertify.set({labels:{ok:'<i class="fas fa-arrow-to-bottom"></i> ‰ª• APK ÂÆâË£Ö',cancel:'<i class="fab fa-google-play"></i> Google Play'},buttonReverse:!0}),alertify.confirm('<i class="fab fa-android"></i> ÂÆâÂçìÁâà App',function(e){e?i?open_url(n.Android.apk):msg('<i class="fal fa-qrcode"></i> Êâ´Êèè‰∫åÁª¥Á†ÅÔºå‰ª•‰∏ãËΩΩ APKÔºö<br><a target="_blank" href="'+n.Android.apk+'"><img src="//i.hearty.app/bSpa73m.png" title="‰∏ãËΩΩ APK"></a>',"Êâ´Êèè‰∫Ü"):open_url(n.Android.play)})):open_url(n.Android.play):open_url(n.iOS[a?"store":"url"]),get_app_events(e?"Android":"iOS",t)})}}function get_app_events(e,t){ga_event_push("Get App",{event_category:"Apps",event_label:e=e||""}),hj_mixpanel("Get App",{platform:e,campaign:t||""})}function hj_firebase_init(){if(window.firebase&&(firebase.initializeApp({apiKey:"AIzaSyAfAW9Zrxe1p-7VGwvCFRVrogSfxLvfptU",authDomain:"hearty-me.firebaseapp.com",databaseURL:"https://hearty-me.firebaseio.com",projectId:"hearty-me",storageBucket:"hearty-me.appspot.com",messagingSenderId:"61745568427",appId:"1:61745568427:web:d7cc2cd1fdd72814b335ee",measurementId:"G-TY63VJYXKY"}),"analytics"in firebase&&firebase.analytics.isSupported().then(e=>{e&&firebase.analytics()}),!check_hjapp()&&firebase.messaging.isSupported())){var e=firebase.messaging();e.usePublicVapidKey("BJGwjWY6MviBp3gKYq8yjJ7LQT-TUBfWphAMmq3biKDqINUv1s6l_qkvyEqF27ox3sxOoJCO_B7VDFS2qtYqozk"),e.onMessage(e=>{var t=e.data;new Notification(t.title,{body:t.body,icon:t.badge})}),window.Notification&&"granted"==Notification.permission&&hj_fcm_init()}}function hj_fcm_init(e){e=e||function(){},check_hjapp()?(location.assign("//hearty.me/wv?r=pushnotification"+(window.hj_username?"&username="+hj_username:"")),e()):window.Notification&&window.firebase&&firebase.messaging.isSupported()?Notification.requestPermission().then(t=>{switch(t){case"granted":var a=firebase.messaging();a.getToken().then(t=>{t?hj_fcm_register(t,e):e()}).catch(t=>{e()}),a.onTokenRefresh(()=>{a.getToken().then(t=>{hj_fcm_register(t,e)}).catch(t=>{e()})});break;case"denied":var n="hearty_notification_denied";getcookie(n)?e():(alertify.set({labels:{ok:_h("h-notify-3"),cancel:'<i class="fas fa-toggle-on"></i> '+_h("h-notify-2")},buttonReverse:!0}),alertify.confirm('<i class="far fa-bell-slash"></i> '+_h("h-notify-0")+"<br>"+_h("h-notify-1")+' <i class="far fa-sad-tear"></i>',function(t){if(!t)switch(check_browser()){case"Safari":open_url("//support.apple.com/guide/safari/sfri40734/mac#ibrw95cba9bb");break;case"Firefox":open_url("//mzl.la/20jwSoU");break;default:open_url("//support.google.com/chrome/answer/3220216")}setcookie(n,1,1),e()}),hj_mixpanel("Push Notification Deny"),ga_event_push("Push Notification Deny"));break;default:e()}}):e()}function hj_fcm_register(e,t){return console.log("FCMtoken: "+e),hj_update({action:"fcm_register",fcmtoken:e,on_mobile:+is_touch_device()}).then(t)}function hj_href(e){$("body").addClass("loading").delay(3500).queue(function(){$(this).removeClass("loading").dequeue()}),e=((e=e||"d").indexOf("//")<0?location.origin+"/":"")+e,top.location.href=e}function hj_go_href(e){hj_href("//go.hearty.me/"+e)}function post_font(e){var t=["openhuninn","taipeisans","wind","jinxuan","cream","wenkai","yozai","naikai","jasonwriting2","jasonwriting1","jasonwriting3","jasonwriting4","jasonwriting5","jasonwriting6","kurewa","lihsianti","nanifont","caramel","oyeh","liao","drechi","genyo","huiwen","ipencrane","lisu","yankai","weibei","bakudai","fist"];if(!(e=e||getcookie("hearty_post_font")||""))return t;var a=t[e=parseInt(e)];return!!a&&($("body").attr("data-font",a),setcookie("hearty_post_font",e,90),_h("a-fonts-"+e))}function webp_profile_image(e){var t="//i.hearty.app/u/";return e?(e=e.split("#"),webp_support()||(e[0]+="?o=1"),e[0]+=e[1]?"#"+e[1]:"",t+e[0]):t+"default.jpg"}function webp_fallback(){if(!webp_support()){$("img[src*='i.hearty.app']").each(function(){this.naturalWidth||$(this).attr({src:webp_downgrade($(this).attr("src"))}).on("error",function(){this.src.indexOf("i.hearty.app")>0&&(this.src=webp_downgrade(this.src))})});var e=$("section,div,figure"),t=check_browser()+" WebP Fallback";["background-image","background"].forEach(function(t){e.filter(function(){var e=$(this).css(t);return e.length>0&&e.indexOf("i.hearty.app")>0}).each(function(){$(this).css(t,webp_downgrade($(this).css(t)))})}),e.filter("[style*='i.hearty.app']").each(function(){$(this).attr({style:webp_downgrade($(this).attr("style"))})}),ga_event_push(t),hj_mixpanel(t)}}function webp_support(){var e=getcookie("hearty_webp");return""==e?$("<img>",{src:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="}).on("load",function(){setcookie("hearty_webp",+($(this).get(0).naturalWidth>0),14)}).on("error",function(){setcookie("hearty_webp",0,14)}).get(0).naturalWidth>0:1==e}function webp_downgrade(e){return(e||"").replace("i.hearty.app/w/","i0.wp.com/").replace(/i.hearty.app\/(\S+)\/(\S+)\.(jp(e|)g|gif|png)(?!(\?)o=1)/gi,"i.hearty.app/$1/$2.$3?o=1")}$.ajaxSetup({scriptCharset:"utf-8",cache:!0}),$.wait=function(e){var t=$.Deferred();return setTimeout(function(){t.resolve()},e),t},$(function(){_h_init(),hj_firebase_init(),webp_fallback()}),check_hostname();