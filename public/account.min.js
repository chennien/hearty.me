var _h$=_h$||{};function account_init(){var e=getUrlPara("tab"),a=getUrlPara("msg"),t=getUrlPara("line");e&&nav_toggle_account(Number(e)),a&&msg('<i class="fal fa-info-circle"></i> '+decodeURIComponent(a)),getUrlPara("ev")?1==$("#email_resend[data-timeout='0']:visible").length&&email_editing():getUrlPara("pc")?password_editing():1==t?account_linenotify():2==t?msg('<i class="fas fa-check-circle"></i> '+_h("a-line_set-4"),'<i class="fas fa-mug"></i> '+_h("a-ok-0"),function(){is_touch_device()?location.href="//line.me/R/ti/p/@linenotify":hj_preview(!1,"line://ti/p/@linenotify")}):getUrlPara("vr")&&voucher_redeem(),(getUrlPara("utm_campaign")||"").indexOf("award")>-1&&$(".chat_btn").remove(),birthday_init(),initialize_uploader(),account_area_calc(),account_usage(),window.addEventListener("resize",()=>{account_area_calc(),nav_toggle_account(0)},{passive:!0}),$(".mh-head .left").on("click",function(){nav_toggle($(".menu"),!0)}),$(".chat_btn").on("click",function(){hj_href("d?f=1")}),$("a[data-linenotify]").on("click",account_linenotify),$("a[data-fonts]").on("click",font_info),$(".hj_preview").on("click",function(){hj_preview(!1)}).find("iframe").on("load",function(){$(this).removeClass("loading")}),[2,12,13,27].forEach(function(e){$("#post_font option[value='"+e+"']").remove()})}function signin_ask(e){var a=getcookie("hearty_account")||"";a=a?"&account="+a:"";var t="?r="+location.href.split("#")[0].split("?")[0].replace(location.origin,"")+a+"#signin";e?hj_href(t):(alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-door-open"></i> '+_h("a-signin-0")},buttonReverse:!1}),alertify.confirm('<i class="fal fa-user-lock"></i> '+_h("a-signin-1"),function(e){e||hj_href(t)}))}function account_area_calc(){$(".account").height($(document).height()-$(".nav_toggle_account").height())}function account_usage(){return hj_update({action:"account_usage"}).then(function(e){var a=$(".usage");if(1==e.Status){var t=e.Values,i=" "+_h("a-usage",{$num:numberWithCommas(t.num||0),$chars:numberWithCommas(t.chars||0)});a.text(i).attr({title:i})}else a.remove()})}function birthday_init(){var e=$("#birthday");(check_OS("iOS")||check_browser("Safari"))&&((navigator.language||"").toLowerCase().startsWith("zh")?hj_getScript_gh({path:"public/safari.datepicker.tw.min.js"},function(){datepicker_load(e)}):datepicker_load(e)),birthday_age(),e.filter("[disabled]").parent().on("click",function(){msg('<i class="fal fa-birthday-cake"></i> '+_h("a-bday_ask-1"))})}function datepicker_load(e){$("<link>",{rel:"stylesheet",href:hj_jsdelivr()+"public/jquery.ui.datepicker.custom.min.css"}).appendTo("head");var a=(new Date).getFullYear();return e.attr({type:"text",readonly:""}).datepicker({changeYear:!0,changeMonth:!0,yearRange:a-70+":"+(a-7),yearSuffix:_h("a-year"),dateFormat:"yy-mm-dd",showAnim:"slideDown",minDate:e.attr("min")||"",maxDate:e.attr("max")||"",showButtonPanel:!0}).on("click",function(){$(this).datepicker("show").select()})}function birthday_editing(e){null!=e&&(alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-ok-3"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm('<i class="fal fa-birthday-cake"></i> '+_h("a-bday_ask-0",{$bday:e.replace(/-/g,"/")}),function(a){a&&hj_update({action:"profile_update",field:"birthday",data:e}).then(function(e){switch(e.Status){case 1:alertify.success('<i class="far fa-birthday-cake"></i> '+_h("a-bday_ask-2")),hj_mixpanel("Profile Update",{action:"Birthday"}),ga_event_push("Birthday",{event_category:"Profile Update",event_label:"Birthday"});break;default:msg()}}).fail(function(){msg()}),birthday_age()}))}function birthday_age(){var e=parseInt((Date.now()-new Date($("#birthday").val()))/315576e5)||0,a=e>0&&e<18,t=$(".menu [data-btn='home'],.menu [data-btn='feed']");return $("#age").text(_h("a-age",{$age:e})),a?t.hide():t.show(),setcookie("hearty_children",a?1:0,7),e}function password_editing(e){if(!email_verified_required(_h("a-pwd_edit")))return!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-pwd_apply-0"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-key"></i> '+(e||_h("a-pwd_enter")),function(e,a){if(e){if(a.length<6||a.length>20)return password_editing(_h("a-pwd_invalid")),alertify_input_shake(),!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-pwd_apply-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-key"></i> '+_h("a-pwd_confirm"),function(e,t){e&&(a==t?hj_update({action:"profile_update",field:"password",data:a}).then(function(e){switch(e.Status){case 1:msg('<i class="fas fa-check-circle"></i> '+_h("a-pwd_ok-0")+"<br><small>"+_h("a-pwd_ok-1")+"</small>"),$(".account_btn[data-password]").attr({"data-password":1,title:_h("a-pwd_edited")}),hj_mixpanel("Profile Update",{action:"Password"}),ga_event_push("Password",{event_category:"Profile Update",event_label:"Password"});break;default:msg()}}).fail(function(){msg()}):(password_editing(_h("a-pwd_mismatch")),alertify_input_shake()))},""),alertify_input_custom({type:"password",placeholder:_h("a-pwd_confirm"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}},""),alertify_input_custom({type:"password",placeholder:_h("a-pwd_format"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}function initialize_uploader(){$("#mulitplefileuploader").uploadFile({url:location.origin+"/update",dragDrop:!0,fileName:"myfile",allowedTypes:"jpg,jpeg,png,gif,bmp",returnType:"json",showDelete:!1,formData:{category:0,privacy:9},onSuccess:function(e,a,t){var i=["//hearty.me/uploads/images/users/"+a.basenames[0],"//i.hearty.app/u/"+a.basenames[0]];$("#profile_image img").attr({src:i[0]}),$(".profile_image div").css({"background-image":'url("'+i[0]+'")'}),alertify.success('<i class="far fa-address-card"></i> '+_h("a-avatar-3")),["","?o=1"].forEach(function(e){$("<img>",{src:i[1]+e})}),hj_mixpanel("Profile Update",{action:"Avatar"}),ga_event_push("Avatar",{event_category:"Profile Update",event_label:"Avatar"})},onError:function(e,a,t,i){msg()}})}function uploader_handle(e){var a=$("#profile_image img"),[t]=e,i=uploader_createImageFromFile(a.get(0),t),n=uploader_getFileBase64Encode(t);Promise.all([i,n]).then(e=>{var[t,i]=e;a.attr("src",i)})}function uploader_createImageFromFile(e,a){return new Promise((t,i)=>{e.src=URL.createObjectURL(a),e.onload=(()=>{URL.revokeObjectURL(e.src),t(e)}),e.onerror=(()=>i("Failure to load image."))})}function uploader_getFileBase64Encode(e){return new Promise((a,t)=>{var i=new FileReader;i.readAsDataURL(e),i.onload=(()=>a(i.result)),i.onerror=(e=>t(e))})}function hj_picture(e){if(e)return alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-arrow-circle-up"></i> '+_h("a-upload")},buttonReverse:!0}),void alertify.confirm('<i class="fal fa-image"></i> '+_h("a-avatar-0"),function(e){e||hj_picture()});var a=$(".ajax-upload-dragdrop input[type='file']").on("change",function(){hj_picture_onselect(this.files)}).attr({accept:"image/jpeg,image/png,image/gif,image/bmp"});a.length>0&&a.get(0).click()}function hj_picture_onselect(e){if(e&&e[0]){var a=(e[0].name||"").toLowerCase().split(".").slice(-1).toString()||"jpg";["jpg","jpeg","png","gif","bmp"].indexOf(a)>=0?uploader_handle(e):(alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-chevron-square-up"></i> '+_h("a-avatar-2")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-image-polaroid"></i> '+_h("a-avatar-1",{$ext:a.toUpperCase()}),function(e){e||hj_picture()}))}}function nickname_editing(e){var a=$("#nickname"),t=$(".account_btn[data-nickname]");if(e)t.fadeIn();else{var i=a.val().trim();hj_update({action:"profile_update",field:"nickname",data:a.val().trim()}).then(function(e){switch(e.Status){case 1:alertify.success('<i class="far fa-user"></i> '+_h("a-nickname_edited",{$n:i})),a.attr({placeholder:i}),t.fadeOut(),hj_mixpanel("Profile Update",{action:"Nickname"}),ga_event_push("Nickname",{event_category:"Profile Update",event_label:"Nickname"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})}}function email_editing(e){e=(e||$("[data-email]").attr("data-email")||"").toLowerCase(),alertify.set({labels:{ok:'<i class="fas fa-chevron-right"></i> '+_h("a-next"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-envelope"></i> '+_h("a-email_new"),function(a,t){a&&(t=(t||"").trim().toLowerCase(),e==t?1==$("#email_resend[data-timeout='0']:visible").length&&email_verification(!1):/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,12}$/.test(t)&&!/@(hearty(\.(me|tw|app)|corp.com)|hj\.rs|ht\.mk|(|chen)nien\.(co(m|)|org))/.test(t)?(alertify.set({labels:{ok:_h("a-ok-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm(_h("a-email_confirm",{$email:t}),function(e){e&&hj_update({action:"profile_update",field:"email",data:t}).then(function(e){switch(e.Status){case 1:email_verification(),$("[data-email-verify]").attr("data-email-verify",0).find("[data-email]").attr("data-email",t),hj_mixpanel("Profile Update",{action:"Email"}),ga_event_push("Email",{event_category:"Profile Update",event_label:"Email"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})})):(msg('<i class="fas fa-times"></i> '+_h("a-email_invalid")),email_editing(t)))},e),alertify_input_custom({type:"email",placeholder:e||"eg. nien@hearty.me",maxlength:64})}function email_verified(){return $("[data-email-verify='1']").length>0}function email_verified_required(e){return!!email_verified()||(msg('<i class="far fa-envelope-open"></i> '+_h("a-email_verify-0")+(e||_h("a-email_verify-1")),_h("a-email_verify-2"),function(){email_editing()}),!1)}function email_verification(e){if(e)alertify.set({labels:{ok:_h("a-ok-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm('<i class="far fa-envelope"></i> '+_h("a-email_send"),function(e){e&&email_verification(!1)});else{var a=$("[data-email-verify]");hj_update({action:"email_verification"}).then(function(e){switch(e.Status){case 1:hj_timer(a.find("#email_resend"),!0),a.attr("data-email-verify",0);var t=e.Values.email_login_url;t.length>0?(alertify.set({labels:{ok:_h("a-ok-0"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm(_h("a-email_sent-0",{$isp:t[0]}),function(e){e&&(check_hjapp()?hj_href("wv?o="+t[1]):open_url("//"+t[1]))})):msg('<i class="fas fa-mailbox"></i> '+_h("a-email_sent-1"),_h("a-ok-0")),hj_mixpanel("Profile Update",{action:"Email Sent"}),ga_event_push("Email Sent",{event_category:"Profile Update",event_label:"Email Sent"});break;case 2:signin_required();break;case 3:msg('<i class="far fa-mobile"></i> '+_h("a-email_verified")),a.attr("data-email-verify",1);break;default:msg()}}).fail(function(){msg()})}}function gender_editing(e){hj_update({action:"profile_update",field:"gender",data:e}).then(function(a){1==a.Status&&(alertify.success('<i class="far fa-'+("1"==e?"mars":"venus")+'"></i> '+_h("a-gender_edited")),hj_mixpanel("Profile Update",{action:"Gender"}),ga_event_push("Gender",{event_category:"Profile Update",event_label:"Gender"}))}).fail(function(){msg()})}function newsletter(e){hj_update({action:"profile_update",field:"newsletter",data:e}).then(function(e){1==e.Status&&(alertify.success('<i class="fal fa-mailbox"></i> '+_h("a-newsletter_edited")),hj_mixpanel("Profile Update",{action:"Newsletter"}),ga_event_push("Newsletter",{event_category:"Profile Update",event_label:"Newsletter"}))}).fail(function(){msg()})}function phone_verification(e,a){hj_href("p/phone.php?cc="+(a||"")+"&no="+(e||""))}function phone_editing_tw(e){e=e||$("[data-phone-tw]").attr("data-phone-tw")||"",alertify.set({labels:{ok:'<i class="far fa-check-circle"></i> 認證號碼',cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt("輸入"+(null==e?"你的":"新的")+"手機號碼（台灣）",function(a,t){a&&(e==t?1==$("#phone_resend[data-timeout='0']:visible").length&&phone_verification_tw(!0):/[0][9][0-9]{8}/.test(t||"")?hj_update({action:"profile_update",field:"phone",data:t}).then(function(e){switch(e.Status){case 1:phone_verification_tw(!0),$("[data-phone-verify-tw]").attr("data-phone-verify-tw",0).find("[data-phone-tw]").attr("data-phone-tw",t),hj_mixpanel("Profile Update",{action:"Phone"}),ga_event_push("Phone",{event_category:"Profile Update",event_label:"Phone"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()}):(msg('<i class="far fa-grin-beam-sweat"></i> 手機格式不正確，需為 09********',"再試試",function(){alertify_input_shake()}),phone_editing_tw(t)))},e),alertify_input_custom({type:"tel",placeholder:e||"eg. 0903904568",maxlength:10},{"letter-spacing":"2px"})}function phone_verification_tw(e,a){var t=$("[data-phone-verify-tw]");e&&a?(alertify.set({labels:{ok:_h("a-ok-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm('<i class="far fa-sms"></i> 確認要重發認證簡訊嗎？',function(e){e&&phone_verification_tw(!0)})):e?hj_update({action:"phone_verification_tw"}).then(function(e){switch(e.Status){case 1:phone_verification_tw(!1),hj_timer(t.find("#phone_resend"),!0),t.attr("data-phone-verify-tw",0),hj_mixpanel("Profile Update",{action:"SMS Sent"}),ga_event_push("SMS Sent",{event_category:"Profile Update",event_label:"SMS Sent"});break;case 2:signin_required();break;case 3:msg('<i class="fas fa-check-circle"></i> 已認證過囉'),t.attr("data-phone-verify-tw",1);break;default:msg()}}).fail(function(){msg()}):(alertify.set({labels:{ok:"認證",cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-mobile"></i> 手機驗證碼',function(e,a){e&&((a=a.replace(/[^0-9]/g,"")).length?hj_update({action:"phone_verification_tw_response",code:a}).then(function(e){1==e.Status?(msg('<i class="fas fa-check-circle"></i> 手機完成認證'),t.attr("data-phone-verify-tw",1),hj_mixpanel("Profile Update",{action:"Phone Verify"}),ga_event_push("Phone Verify",{event_category:"Profile Update",event_label:"Phone Verify"})):(msg('<i class="fas fa-times"></i> 驗證碼不符'),phone_verification_tw(!1))}).fail(function(){msg()}):(phone_verification_tw(!1),alertify_input_shake()))},""),alertify_input_custom({type:"tel",placeholder:"eg. 123",maxlength:3,onkeyup:"if(this.value.length==3) $('#alertify-ok').click()"},{"letter-spacing":"3px"}))}function hj_timer(e,a,t){a?(hj_timer(e,!1),$.wait(1e3).then(function(){t=t||60,e.attr("data-timeout",t),function a(){if(Number(e.attr("data-timeout"))>0){var i=--t>0?parseInt(t%60,10).toString().padStart(2,"0"):"";t>0&&$.wait(1e3).then(a),e.attr("data-timeout",t).text(i)}}()})):e.attr("data-timeout",0).text("")}function support_pincode(e){hj_update({action:"support_pincode",reissue:+!(null==e)}).then(function(e){1==e.Status&&msg('<i class="far fa-comment-dots"></i> '+_h("a-pin",{$pin:e.Values.pincode}),'<i class="fas fa-hand-peace"></i> '+_h("a-ok-0"),function(){var e=$("#Smallchat iframe");e.length>0&&!is_touch_device()&&e.contents().find(".Launcher").click()})}).fail(function(){msg()})}function font_info(e){e?(alertify.set({labels:{ok:'<i class="fas fa-copyright"></i> '+_h("a-font-4"),cancel:_h("a-ok-0")},buttonReverse:!0}),alertify.confirm('<img src="//i.hearty.app/'+_h("a-font-1")+'" title="'+_h("a-font-0")+'" alt="'+_h("a-font-0")+'">',function(e){e&&font_info(!1)})):msg('<i class="fal fa-file-certificate"></i> '+_h("a-font-2")+'<br><i class="fal fa-info-circle"></i> '+_h("a-font-3"))}function post_font_change(e,a){post_font(e),hj_update({action:"profile_update",field:"post_font",data:e}).then(function(e){switch(e.Status){case 1:alertify.success('<i class="far fa-font-case"> '+_h("a-font_change",{$font:a})),hj_mixpanel("Profile Update",{action:"Post_Font"}),ga_event_push("Post_Font",{event_category:"Profile Update",event_label:"Post_Font"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})}function timezone_editing(e,a){hj_update({action:"profile_update",field:"timezone",data:e}).then(function(a){switch(a.Status){case 1:alertify.success('<i class="far fa-clock"></i> '+_h("a-timezone_edited",{$tz:e})),hj_mixpanel("Profile Update",{action:"Timezone"}),ga_event_push("Timezone",{event_category:"Profile Update",event_label:"Timezone"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})}function username_details(){var e=$(".hj_username").attr("title")||"";alertify.set({labels:{ok:'<i class="fas fa-sync"></i> '+_h("a-id_edit"),cancel:'<i class="fas fa-hand-peace"></i> '+_h("a-back")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-user"></i> '+_h("a-id")+"<u>"+e+'</u> <i class="far fa-globe-asia"></i><br>('+_h("a-id_public")+")",function(a){a&&username_editing(e)})}function username_validate(e){return(e||"").toLowerCase().replace(/[\W_]+/g,"")}function username_editing(e,a){if(!email_verified_required(_h("a-id_edit")))return!1;alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-id_edit"),cancel:""+_h("a-no")},buttonReverse:!0}),alertify.prompt('<i class="fal fa-user"></i> '+_h("a-id_new")+'<br><i class="fal fa-info-circle"></i> '+(a||_h("a-id_format")),function(a,t){if(a){if(t=(t||"").trim().toLowerCase(),e==t)return username_editing(e,_h("a-id_same")),void alertify_input_shake();if(t.length<4||!isNaN(t)||!/^[a-z0-9]*$/.test(t))return username_editing(e,_h("a-id_invalid")),void alertify_input_shake();hj_update({action:"username_editing",username:t}).then(function(a){switch(a.Status){case 1:msg('<i class="fal fa-check-circle"></i> '+_h("a-id_edited",{$id:t}),'<i class="fas fa-door-open"></i> '+_h("a-id_signout"),signout),setcookie("hearty_account",t,90),hj_update({action:"gform_post",uri:"1FAIpQLScMUCYu17vjPovyr8Ywr9wbgfVxZ7E5FPYvqdpbPdlEw7TMVQ",data:$.param({"entry.1182370364":"[hj_user_id]","entry.847068538":"[hj_username]",emailAddress:"[hj_email]","entry.1353731030":t,"entry.1460125899":(new Date).toISOString().split("T")[0],"entry.1757674378":navigator.userAgent||""})}),hj_mixpanel("Profile Update",{action:"Username"}),ga_event_push("Username",{event_category:"Profile Update",event_label:"Username"});break;default:return username_editing(e,_h("a-id_taken",{$id:t})),void alertify_input_shake()}}).fail(function(){msg()})}},e),alertify_input_custom({type:"search",autocomplete:"off",placeholder:_h("a-id_format"),minlength:4,maxlength:20,onkeyup:"this.value=username_validate(this.value)"},{"letter-spacing":"3px","ime-mode":"disabled"})}function booktitle_editing(e){account_status().then(function(a){1==a.Values.vip?(alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-name-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="fal fa-book"></i> '+_h("a-name-1"),function(e,a){e&&(a=(a||"").trim()).length>0&&hj_update({action:"profile_update",field:"booktitle",data:a}).then(function(e){switch(e.Status){case 1:$("#hj_booktitle").text(a).attr({title:a}),alertify.success('<i class="fal fa-book"></i> '+_h("a-name-3",{$title:a})),hj_mixpanel("Profile Update",{action:"BookTitle"}),ga_event_push("BookTitle",{event_category:"Profile Update",event_label:"BookTitle"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})},(e||"溫度日記").toString()),alertify_input_custom({placeholder:"eg. "+_h("a-name-4"),maxlength:20},{"letter-spacing":"2px"})):vip_only(_h("a-name-0"))})}function nav_toggle_account(e){var a=$(".account");a.length>0&&($(".nav_toggle_account li").removeAttr("data-active").eq(e).attr("data-active",""),e=a.width()*(e||0),check_browser("Safari")?a.animate({scrollLeft:e},450):a.scrollLeft(e),a.children("div").scrollTop(0))}function export_txt(e){hj_loading(!0),account_status().then(function(a){if(1==a.Values.vip){if(is_touch_device())return msg('<i class="far fa-desktop"></i> '+_h("a-dl_pc")),hj_loading(!1),export_txt_stats("use_pc_instead"),!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-dl_pwd-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt(e||'<i class="far fa-briefcase"></i> '+_h("a-dl_pwd-0"),function(e,a){if(e){if(a.length<6||a.length>20)return export_txt('<i class="far fa-info-circle"></i> '+_h("a-dl_pwd-1")),alertify_input_shake(),export_txt_stats("password_malformatted"),!1;$("<form>",{method:"post",target:"_self",action:location.origin+"/update",enctype:"application/x-www-form-urlencoded",html:$("<input>",{type:"hidden",name:"action",value:"export_txt"}).add($("<input>",{type:"hidden",name:"password",value:a}))}).appendTo("body").submit(),alertify.success('<i class="far fa-arrow-to-bottom"></i> '+_h("a-dl_pwd-3")),$.wait(2e3).then(function(){export_txt_stats("txt_exported"),hj_mixpanel("Posts Exported"),ga_event_push("Posts Exported",{event_category:"Posts",event_label:"Posts Exported"}),msg('<i class="fab fa-wpforms"></i> '+_h("a-dl_pwd-4"),_h("a-ok-1"))})}$.wait(1e3).then(function(){hj_loading(!1)})},""),alertify_input_custom({type:"password",placeholder:_h("a-dl_pwd-1"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}else vip_only(_h("a-dl")),hj_loading(!1),export_txt_stats("notice_upgrade")}).fail(function(){msg(),hj_loading(!1)})}function export_txt_stats(e){return hj_update({action:"gform_post",uri:"1FAIpQLSfvmnOWgvwQfBjQIoJeH6EzxLUq62mwcRB7RQeODoWF1oC7Pg",data:$.param({emailAddress:"[hj_email]","entry.1537657449":"[hj_user_id]","entry.1470526977":"[hj_username]","entry.1332414907":e||"","entry.164417788":check_browser()+", "+check_OS(),"entry.657077146":(new Date).toISOString().split("T")[0]})})}function vip_only(e){alertify.set({labels:{ok:_h("a-vip_only-3"),cancel:'<i class="fas fa-star"></i> '+_h("a-vip_only-2")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-box-full"></i> '+(e?"「"+e+"」":_h("a-vip_only-0"))+_h("a-vip_only-1"),function(e){e||hj_href("d?plans=1")})}function account_suspend(){alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-ban"></i> '+_h("a-suspend-2")},buttonReverse:!1}),alertify.confirm('<i class="far fa-exclamation-triangle"></i> '+_h("a-suspend-0")+'<br>(<a onclick="$(\'#alertify-ok\').click();username_details()" href="javascript:void(0)">'+_h("a-suspend-1")+"</a>)",function(e){e||open_url("//docs.google.com/forms/d/e/1FAIpQLSfVJkAOUtBdmwXo6Hc7GBoCRnXBk41PRdcutHnHfgkrBBL3oA/viewform?embedded=true&emailAddress="+$("[data-email]").attr("data-email")+"&entry.537131775="+$(".hj_username").attr("title")+"&entry.1511837812="+check_browser()+", "+check_OS())}),hj_vibrate(80)}function signin_history(){hj_update({action:"signin_history"}).then(function(e){if(1==e.Status){var a=e.Values.map(function(e){return $("<tr>",{html:$("<td>",{text:_h("a-auth_log-1",{$device:e.device,$browser:e.browser})}).add($("<td>",{text:e.date}))}).prop("outerHTML")});alertify.set({labels:{ok:'<i class="fas fa-reply"></i> '+_h("a-back"),cancel:'<i class="fas fa-shield-check"></i> '+_h("a-auth_log-2")},buttonReverse:!0}),alertify.confirm("<h3>"+_h("a-auth_log-0")+"</h3>"+$("<table>",{class:"signin_history",html:a.join("")}).prop("outerHTML"),function(e){e||window.open("//faq.hearty.me/faq/enhance-security","_blank")})}})}function voucher_redeem(e){e=e||getcookie("hearty_voucher")||"";var a="Voucher Redeem";alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-redeem-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-gift-card"></i> '+_h("a-redeem-0"),function(e,t){e&&((t=(t||"").trim()).length<4?(redeem_voucher(t),alertify_input_shake()):/metro|mohot/gi.test(t)&&parseInt((new Date).toISOString().slice(0,10).replace(/-/g,""))<20220101?hj_update({action:"gform_post",uri:"1FAIpQLSdUp4rnErJoEynfg60KgLrkF-7r5qzUh8rScViJ5CmGbwEoLg",data:$.param({"entry.1182370364":"[hj_user_id]","entry.847068538":"[hj_username]",emailAddress:"[hj_email]","entry.1353731030":t,"entry.1460125899":(new Date).toISOString().split("T")[0],"entry.1757674378":check_browser()+", "+check_OS()})}).then(function(){msg('<i class="far fa-gift-card"></i> '+h("a-coupon_ok-0",{$coupon:t})+' <i class="far fa-check-circle"></i><br>'+h("a-coupon_ok-1"),'<i class="fas fa-thumbs-up"></i> '+h("a-ok-0"),function(){hj_href("d")}),setcookie("hearty_voucher","",0),hj_mixpanel(a),ga_event_push(a)}).fail(function(){msg()}):$.ajax({url:location.origin+"/gift/"+t,type:"post",dataType:"json",data:{voucher:t},async:!0,xhrFields:{withCredentials:!0}}).then(function(e){switch(e.Status){case 0:msg('<i class="far fa-times-circle"></i> '+_h("a-voucher_invalid"),_h("a-retry"),function(){redeem_voucher(),alertify_input_shake()});break;case 1:msg('<i class="far fa-gift"></i> '+h("a-voucher_ok",{$voucher:t})+' <i class="far fa-check-circle"></i>','<i class="fas fa-thumbs-up"></i> '+h("a-ok-0"),function(){location.reload()}),hj_mixpanel(a),ga_event_push(a);break;default:msg()}}).fail(function(){msg()}))},e),alertify_input_custom({oninput:"this.value=this.value.toUpperCase()",placeholder:_h("a-redeem-0")},{"ime-mode":"disabled","letter-spacing":"2px"})}function hj_preview(e,a){var t=$("body"),i=$(".hj_preview"),n=i.find("iframe");return(a=a||"")&&n.attr({src:a}).addClass("loading"),e?(i.fadeIn(),t.css({"overflow-y":"hidden","touch-action":"none"})):(i.fadeOut(),t.css({"overflow-y":"auto","touch-action":"auto"})),n}function account_linenotify(){hj_update({action:"account_linenotify"}).then(function(e){var a=1==e.Status;alertify.set({labels:{ok:'<i class="fas fa-hand-point-right"></i> '+(a?_h("a-line_set-3"):_h("a-line_set-2")),cancel:_h("a-back")},buttonReverse:!1}),alertify.confirm('<i class="far fa-info-circle"></i> '+(a?_h("a-line_set-1",{$date:e.Values.date}):_h("a-line_set-0")+'<br><img src="//i.hearty.app/BfMM4x9.png">'),function(e){if(e){var a="//go.hearty.me/ln";is_touch_device()?window.open(a,"_blank"):hj_preview(!0,"line://ti/p/@uiv1093y").delay(30).queue(function(){$(this).attr({src:a}).dequeue()})}})})}function hj_loading(e){var a=$("body");e?a.addClass("loading"):a.removeClass("loading")}_h$.a=_h$.a||{ok:["好的","是的","就這麼辦","正確"],next:"下一步",no:"否",back:"返回",upload:"上傳",retry:"再試一次",signin:["立即登入","登入以使用完整功能"],usage:"寫作里程： $num篇日記，共 $chars字",year:"年",bday_ask:["您的生日是：$bday 嗎？","生日設置後無法更改","生日已更新"],age:"$age 歲",nickname_edited:"筆名取為「$n」",pwd_edit:"變更密碼",pwd_edited:"已變更",pwd_enter:"請輸入主帳號的新密碼",pwd_confirm:"再次輸入，以設置新密碼",pwd_invalid:"密碼格式：6 ~ 20 字元，請重新輸入",pwd_mismatch:"兩次輸入不一樣，請重新輸入",pwd_format:"6 ~ 20 字之間",pwd_apply:["更改","確認更改"],pwd_ok:["密碼已修改，下次登入請使用新密碼","請勿與他人共用帳號，或將密碼提供給任何人"],avatar:["選擇一張相片 (JPG、PNG)","所選檔案為 $ext，只能傳 JPG、PNG 圖片","重新選擇","大頭貼已更新"],email_new:"修改 Email",email_confirm:"確認修改 Email 為「$email」？",email_invalid:"Email 格式不符",email_verify:["為保障帳號安全，需先認證 Email，方能","使用完整功能","前往認證"],email_send:"確認要重寄認證信嗎？",email_sent:["認證信已寄出，要到 $isp 收信嗎？<br>(請同時檢查垃圾信匣)","麻煩前往收信，同時檢查垃圾信匣"],email_verified:"Email 已認證過囉",pin:"客服 PIN 碼：$pin<br><small>(聯繫時，提供這組數字，以加速身份認證)</small>",font:["溫度日記特色字體","本站使用 justfont 網頁字型、各類商用授權及開源字型。",'版權資訊：<a target="_blank" href="//r.hj.rs/MZq52m">[oz 焦糖手寫]</a>',"授權資訊"],font_change:"正在更換：「$font」",gender_edited:"性別已更新",newsletter_edited:"電子報訂閱已更新",timezone_edited:"時區設置為「$tz」",id:"溫度 ID：",id_edit:"申請更換 ID",id_public:"交流社群中，ID 與筆名為公開資訊",id_new:"輸入新的 ID",id_format:"4字以上英字母(或英數組合)，僅可變更一次",id_invalid:"ID 格式不符規範",id_same:"不能與原 ID 相同",id_taken:"「<b>$id</b>」有人使用了，請重新選擇",id_edited:"溫度 ID 已更新為「<b>$id</b>」",id_signout:"登出，以新 ID 登入",name:["自訂書名","我的日記本本叫作：","取名字","新書名「$title」","Alice 的日記小本本"],dl:"匯出備份",dl_pc:"要下載日記備份檔，需使用電腦版<br>請在電腦上打開「www.hearty.me」",dl_pwd:["備份日記，請輸入溫度密碼以解密：","密碼格式：6 ~ 20 字之間","解密並匯出","開始備份","已將日記解密並轉存文字檔，<br>敬請妥善保管"],vip_only:["這","是 VIP 專屬功能","升級享優惠","稍後升級"],suspend:["不再使用溫度日記帳號<br>帳號刪除後，資料將清除且不得使用相同 ID 及信箱再度註冊","如需修改 ID，請<u>點此</u>","申請永久刪除"],auth_log:["近期登入紀錄","$device 的 $browser","增強安全性"],redeem:["填寫序號","兌換"],coupon_ok:["優惠序號「$coupon」兌換成功","VIP 30日體驗方案，將於 3天內派至帳號中，<br>請於【大頭貼】>【我的訂閱】中查看"],voucher_ok:"專屬序號「$voucher」兌換成功",voucher_invalid:"這組序號失效了，或已兌換",line_set:["請選擇「1對1聊天」綁定 Line 貼心通知：","已於 $date 設定過 Line Notify","快速綁定","再次綁定","已綁定 Line Notify"],title:"我的帳號",tab:["個人資料","我的方案"],book:["書名","溫度日記"],nickname:["筆名","修改"],pincode:"客服 PIN 碼",bday:"生日",email:["寄發認證 Email","重發驗證信"," 秒後可重發"],gender:["性別","男","女"],phone:["手機","驗證手機號碼"],pwd:"密碼",pfont:["日記字體","字體預覽"],language:"語言",timezone:"時區",line:["貼心通知","以 Line Notify 訂閱通知"],newsletter:["電子報","訂閱暖心通知"],rate:["鼓勵我們","給 5顆小星星"],misc:"其他",auth:["登入紀錄","刪除帳號"],chat:"問問題",fonts:["jf open 粉圓","台北黑體","玉川風體","jf 金萱","jf 凝書","霞鶩文楷","悠哉手寫","內海手寫","清松手寫 A","清松手寫 B","清松手寫 C","清松手寫 D","清松手寫 E","清松手寫 F","jf 粒線手寫","何某手寫","oz 焦糖手寫","jf 葉書手寫","jf 文強手寫","jf 追奇手寫","源樣明體","匯文明朝古印","鋼筆鶴體","王漢宗隸書","王漢宗顏楷","王漢宗魏碑","莫大毛筆","玉川拳體"]},_h$.o=_h$.o||{back:"返回",redeem:"序號兌換",buy:["購買溫度日記","續訂溫度日記"],plan:["我的方案","如需調整使用方案，請私訊站內客服，並提供 ID","「VIP 試用版」為新用戶專享的小禮物<br>到期後，將自動降為基本版"],order:["我的訂單"],plan_th:["狀態","方案","起始日","到期日","溫度日記 "],order_th:["狀態","訂單編號","商品","金額","付款方式","發票"]};