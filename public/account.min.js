"use strict";function account_init(){var a=getUrlPara("tab"),b=getUrlPara("vr"),c=getUrlPara("msg"),d=getUrlPara("line");a&&nav_toggle_account(Number(a)),c&&msg('<i class="fal fa-info-circle"></i> '+decodeURIComponent(c)),getUrlPara("ev")?1==$("#email_resend[data-timeout='0']:visible").length&&email_editing():getUrlPara("pc")?password_editing():1==d?account_linenotify():2==d?msg('<i class="fas fa-check-circle"></i> '+_h("a-line_set-4"),'<i class="fas fa-mug"></i> '+_h("a-ok-0"),function(){is_touch_device()?location.href="//"+(/iOS|Android/i.test(check_hjapp())?"hearty.me/wv?o=":"")+"line.me/R/ti/p/@linenotify":hj_preview(!1,"line://ti/p/@linenotify")}):1==b?voucher_redeem():2==b&&msg('<i class="far fa-times-circle"></i> '+_h("a-voucher_invalid"),_h("a-retry"),function(){voucher_redeem()}),(getUrlPara("utm_campaign")||"").indexOf("award")> -1&&$(".chat_btn").remove(),birthday_init(),initialize_uploader(),account_area_calc(),account_usage(),language_editing(),window.addEventListener("resize",function(){account_area_calc(),nav_toggle_account(0)},{passive:!0}),$(".mh-head .left").on("click",function(){nav_toggle($(".menu"),!0)}),$(".chat_btn").on("click",function(){hj_href("d?f=1")}),$("a[data-linenotify]").on("click",account_linenotify),$("a[data-fonts]").on("click",font_info),$(".hj_preview").on("click",function(){hj_preview(!1)}).find("iframe").on("load",function(){$(this).removeClass("loading")}),[2,12,22,23,24,25,26,27,28,29,30].forEach(function(a){$("#post_font option[value='"+a+"']").remove()}),document.title=_h("a-title")+" | \u{1F49D} Hearty Journal \u6EAB\u5EA6\u65E5\u8A18"}function signin_ask(b){var a=getcookie("hearty_account")||"";a=a?"&account="+a:"";var c="?r="+location.href.split("#")[0].split("?")[0].replace(location.origin,"")+a+"#signin";b?hj_href(c):(alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-door-open"></i> '+_h("a-signin-0")},buttonReverse:!1}),alertify.confirm('<i class="fal fa-user-lock"></i> '+_h("a-signin-1"),function(a){a||hj_href(c)}))}function account_area_calc(){$(".account").height($(document).height()-$(".nav_toggle_account").height())}function account_usage(){return hj_update({action:"account_usage"}).then(function(a){var b=$(".usage");if(1==a.Status){var c=a.Values,d=" "+_h("a-usage",{$num:numberWithCommas(c.num||0),$chars:numberWithCommas(c.chars||0)});b.text(d).attr({title:d})}else b.remove()})}function birthday_init(){var a=$("#birthday");(check_OS("iOS")||check_browser("Safari"))&&(/zh/i.test(hj_lang())?hj_getScript_gh({path:"public/safari.datepicker.tw.min.js"},function(){datepicker_load(a)}):datepicker_load(a)),birthday_age(),a.filter("[disabled]").parent().on("click",function(){msg('<i class="fal fa-birthday-cake"></i> '+_h("a-bday_ask-1"))})}function datepicker_load(a){$("<link>",{rel:"stylesheet",href:hj_jsdelivr()+"public/jquery.ui.datepicker.custom.min.css"}).appendTo("head");var b=new Date().getFullYear();return a.attr({type:"text",readonly:""}).datepicker({changeYear:!0,changeMonth:!0,yearRange:b-70+":"+(b-7),yearSuffix:_h("a-year"),dateFormat:"yy-mm-dd",showAnim:"slideDown",minDate:a.attr("min")||"",maxDate:a.attr("max")||"",showButtonPanel:!0}).on("click",function(){$(this).datepicker("show").select()})}function birthday_editing(a){null!=a&&(alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-ok-3"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm('<i class="fal fa-birthday-cake"></i> '+_h("a-bday_ask-0",{$bday:a.replace(/-/g,"/")}),function(b){b&&hj_update({action:"profile_update",field:"birthday",data:a}).then(function(a){1===a.Status?(alertify.success('<i class="far fa-birthday-cake"></i> '+_h("a-bday_ask-2")),hj_mixpanel("Profile Update",{action:"Birthday"}),ga_event_push("Birthday",{event_category:"Profile Update",event_label:"Birthday"})):msg()}).fail(function(){msg()}),birthday_age()}))}function birthday_age(){var a=parseInt((Date.now()-new Date($("#birthday").val()))/315576e5)||0,b=a>0&&a<18,c=$(".menu [data-btn='home'],.menu [data-btn='feed']");return $("#age").text(_h("a-age",{$age:a})),b?c.hide():c.show(),setcookie("hearty_children",b?1:0,7),a}function password_editing(a){if(!email_verified_required(_h("a-pwd_edit")))return!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-pwd_apply-0"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-key"></i> '+(a||_h("a-pwd_enter")),function(b,a){if(b){if(a.length<6||a.length>20)return password_editing(_h("a-pwd_invalid")),alertify_input_shake(),!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-pwd_apply-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-key"></i> '+_h("a-pwd_confirm"),function(b,c){b&&(a==c?hj_update({action:"profile_update",field:"password",data:a}).then(function(a){1===a.Status?(msg('<i class="fas fa-check-circle"></i> '+_h("a-pwd_ok-0")+"<br><small>"+_h("a-pwd_ok-1")+"</small>"),$(".account_btn[data-password]").attr({"data-password":1,title:_h("a-pwd_edited")}),hj_mixpanel("Profile Update",{action:"Password"}),ga_event_push("Password",{event_category:"Profile Update",event_label:"Password"})):msg()}).fail(function(){msg()}):(password_editing(_h("a-pwd_mismatch")),alertify_input_shake()))},""),alertify_input_custom({type:"password",placeholder:_h("a-pwd_confirm"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}},""),alertify_input_custom({type:"password",placeholder:_h("a-pwd_format"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}function initialize_uploader(){$("#mulitplefileuploader").uploadFile({url:location.origin+"/update",dragDrop:!0,fileName:"myfile",allowedTypes:"jpg,jpeg,png,bmp",returnType:"json",showDelete:!1,formData:{category:0,privacy:9},onSuccess:function(c,b,d){var a="//i.hearty.app/u/"+b.basenames[0];$("#profile_image img").attr({src:a}),$(".profile_image div").css({"background-image":'url("'+a+'")'}),picture_rotate(),alertify.success('<i class="far fa-address-card"></i> '+_h("a-avatar-3")),["","?o=1"].forEach(function(b){$("<img>",{src:a+b})}),hj_mixpanel("Profile Update",{action:"Avatar"}),ga_event_push("Avatar",{event_category:"Profile Update",event_label:"Avatar"})},onError:function(b,c,a,d){msg("Error: "+JSON.stringify(a))}})}function uploader_handle(b){var c=$("#profile_image img"),[a]=b,d=uploader_createImageFromFile(c.get(0),a),e=uploader_getFileBase64Encode(a);Promise.all([d,e]).then(function(a){var[d,b]=a;c.attr("src",b)})}function uploader_createImageFromFile(a,b){return new Promise((c,d)=>{a.src=URL.createObjectURL(b),a.onload=()=>{URL.revokeObjectURL(a.src),c(a)},a.onerror=()=>d("Failure to load image.")})}function uploader_getFileBase64Encode(a){return new Promise((c,d)=>{var b=new FileReader;b.readAsDataURL(a),b.onload=()=>c(b.result),b.onerror=a=>d(a)})}function hj_picture(b){if(b){alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-arrow-circle-up"></i> '+_h("a-upload")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-image"></i> '+_h("a-avatar-0"),function(a){a||hj_picture()});return}var a=$(".ajax-upload-dragdrop input[type='file']").on("change",function(){hj_picture_onselect(this.files)}).attr({accept:"image/jpeg,image/png,image/gif,image/bmp"});a.length>0&&a.get(0).click()}function hj_picture_onselect(a){if(a&&a[0]){var b=(a[0].name||"").toLowerCase().split(".").slice(-1).toString()||"jpg";["jpg","jpeg","png","gif","bmp"].indexOf(b)>=0?uploader_handle(a):(alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-chevron-square-up"></i> '+_h("a-avatar-2")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-image-polaroid"></i> '+_h("a-avatar-1",{$ext:b.toUpperCase()}),function(a){a||hj_picture()}))}}function picture_rotate(){var a=$("#profile_image img");alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-ok-1"),cancel:'<i class="fas fa-undo fa-flip-horizontal"></i> '+_h("a-rotate")},buttonReverse:!1}),alertify.confirm(a.prop("outerHTML"),function(c){if(!c){var b=(a.attr("src")||"").split("#");b[1]=b[1]||0,b[1]++,b=4==b[1]?b[0]:b.join("#"),a.add(".alertify img").attr({src:b}),$(".profile_image div").css("background-image","url("+b+")"),hj_update({action:"profile_update",field:"profile_image",data:b.split("/").pop()||""}),picture_rotate(),hj_mixpanel("Rotate Picture"),ga_event_push("Rotate Picture")}})}function nickname_editing(b){var a=$("#nickname"),c=$(".account_btn[data-nickname]");if(b)c.fadeIn();else{var d=a.val().trim();hj_update({action:"profile_update",field:"nickname",data:a.val().trim()}).then(function(b){switch(b.Status){case 1:alertify.success('<i class="far fa-user"></i> '+_h("a-nickname_edited",{$n:d})),a.attr({placeholder:d}),c.fadeOut(),hj_mixpanel("Profile Update",{action:"Nickname"}),ga_event_push("Nickname",{event_category:"Profile Update",event_label:"Nickname"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})}}function email_editing(a){a=(a||$("[data-email]").attr("data-email")||"").toLowerCase(),alertify.set({labels:{ok:'<i class="fas fa-chevron-right"></i> '+_h("a-next"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-envelope"></i> '+_h("a-email_new"),function(c,b){c&&(a==(b=(b||"").trim().toLowerCase())?1==$("#email_resend[data-timeout='0']:visible").length&&email_verification(!1):/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,12}$/.test(b)&&!/@(hearty(\.(me|app|gift)|mail\.com)|miss\.com\.tw|hj\.rs|ht\.mk|(|chen)nien\.(co(m|)|org))/.test(b)?(alertify.set({labels:{ok:_h("a-ok-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm(_h("a-email_confirm",{$email:b}),function(a){a&&hj_update({action:"profile_update",field:"email",data:b}).then(function(a){switch(a.Status){case 1:email_verification(),$("[data-email-verify]").attr("data-email-verify",0).find("[data-email]").attr("data-email",b),hj_mixpanel("Profile Update",{action:"Email"}),ga_event_push("Email",{event_category:"Profile Update",event_label:"Email"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})})):(msg('<i class="fas fa-times"></i> '+_h("a-email_invalid")),email_editing(b)))},a),alertify_input_custom({type:"email",placeholder:a||"eg. nien@hearty.me",maxlength:64})}function email_verified(){return $("[data-email-verify='1']").length>0}function email_verified_required(a){return!!email_verified()||(msg('<i class="far fa-envelope-open"></i> '+_h("a-email_verify-0")+(a||_h("a-email_verify-1")),_h("a-email_verify-2"),function(){email_editing()}),!1)}function email_verification(a){if(a)alertify.set({labels:{ok:_h("a-ok-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm('<i class="far fa-envelope"></i> '+_h("a-email_send"),function(a){a&&email_verification(!1)});else{var b=$("[data-email-verify]");hj_update({action:"email_verification"}).then(function(a){switch(a.Status){case 1:hj_timer(b.find("#email_resend"),!0),b.attr("data-email-verify",0);var c=a.Values.email_login_url;c.length>0?(alertify.set({labels:{ok:_h("a-ok-0"),cancel:_h("a-no")},buttonReverse:!1}),alertify.confirm(_h("a-email_sent-0",{$isp:c[0]}),function(a){a&&(/iOS|Android/i.test(check_hjapp())?hj_href("wv?o="+c[1]):open_url("//"+c[1]))})):msg('<i class="fas fa-mailbox"></i> '+_h("a-email_sent-1"),_h("a-ok-0")),hj_mixpanel("Profile Update",{action:"Email Sent"}),ga_event_push("Email Sent",{event_category:"Profile Update",event_label:"Email Sent"});break;case 2:signin_required();break;case 3:msg('<i class="far fa-mobile"></i> '+_h("a-email_verified")),b.attr("data-email-verify",1);break;default:msg()}}).fail(function(){msg()})}}function gender_editing(a){hj_update({action:"profile_update",field:"gender",data:a}).then(function(b){1==b.Status&&(alertify.success('<i class="far fa-'+("1"==a?"mars":"venus")+'"></i> '+_h("a-gender_edited")),hj_mixpanel("Profile Update",{action:"Gender"}),ga_event_push("Gender",{event_category:"Profile Update",event_label:"Gender"}))}).fail(function(){msg()})}function newsletter(a){hj_update({action:"profile_update",field:"newsletter",data:a}).then(function(a){1==a.Status&&(alertify.success('<i class="fal fa-mailbox"></i> '+_h("a-newsletter_edited")),hj_mixpanel("Profile Update",{action:"Newsletter"}),ga_event_push("Newsletter",{event_category:"Profile Update",event_label:"Newsletter"}))}).fail(function(){msg()})}function phone_verification(a){hj_href("p/phone.php?cc="+((a=a.find("[data-phone-no]")).attr("data-phone-cc")||"")+"&no="+(a.attr("data-phone-no")||""))}function hj_timer(a,b,c){b?(hj_timer(a,!1),$.wait(1e3).then(function(){c=c||60,a.attr("data-timeout",c),function b(){if(Number(a.attr("data-timeout"))>0){var d=--c>0?parseInt(c%60,10).toString().padStart(2,"0"):"";c>0&&$.wait(1e3).then(b),a.attr("data-timeout",c).text(d)}}()})):a.attr("data-timeout",0).text("")}function support_pincode(a){hj_update({action:"support_pincode",reissue:+(null!=a)}).then(function(a){if(1==a.Status){var b=a.Values.pincode;alertify.set({labels:{ok:'<i class="fas fa-arrow-alt-to-bottom"></i> '+_h("a-pin-1"),cancel:'<i class="fas fa-reply"></i> '+_h("a-back")},buttonReverse:!1}),alertify.confirm('<i class="far fa-comment-dots"></i> '+_h("a-pin-0",{$pin:b}),function(c){c&&$("<a>",{href:"data:text/plain;charset=utf-8,"+encodeURIComponent(b),download:"Hearty-PINcode.txt"}).get(0).click();var a=$("#Smallchat iframe");a.length>0&&!is_touch_device()&&a.contents().find(".Launcher").click()})}}).fail(function(){msg()})}function font_info(a){a?(alertify.set({labels:{ok:'<i class="fas fa-copyright"></i> '+_h("a-font-3"),cancel:_h("a-ok-0")},buttonReverse:!0}),alertify.confirm('<img src="//i.hearty.app/'+_h("a-font-1")+'" title="'+_h("a-font-0")+'" alt="'+_h("a-font-0")+'">',function(a){a&&font_info(!1)})):msg('<i class="fal fa-file-certificate"></i> '+_h("a-font-2"))}function post_font_change(a,b){post_font(a),hj_update({action:"profile_update",field:"post_font",data:a}).then(function(){alertify.success('<i class="far fa-font-case"> '+_h("a-font_change",{$font:b})),hj_mixpanel("Profile Update",{action:"Post_Font"}),ga_event_push("Post_Font",{event_category:"Profile Update",event_label:"Post_Font"})})}function language_editing(a,b){if(a)msg('<i class="far fa-language" style="font-size:26px"></i> '+_h("i-lang",{$lang:b})),hj_update({action:"profile_update",field:"language",data:a}).then(function(a){switch(a.Status){case 1:hj_mixpanel("Profile Update",{action:"Language"}),ga_event_push("Language",{event_category:"Profile Update",event_label:"Language"}),location.reload(!0);break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()});else var a=parseInt($("#language").val())||1;setcookie("hearty_language",a,730)}function timezone_editing(a){hj_update({action:"profile_update",field:"timezone",data:a}).then(function(b){switch(b.Status){case 1:alertify.success('<i class="far fa-clock"></i> '+_h("a-timezone_edited",{$tz:a})),hj_mixpanel("Profile Update",{action:"Timezone"}),ga_event_push("Timezone",{event_category:"Profile Update",event_label:"Timezone"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})}function username_details(){var a=$(".hj_username").attr("title")||"";alertify.set({labels:{ok:'<i class="fas fa-sync"></i> '+_h("a-id_edit"),cancel:'<i class="fas fa-hand-peace"></i> '+_h("a-back")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-user"></i> '+_h("a-id")+"<u>"+a+'</u> <i class="far fa-globe-asia"></i><br>('+_h("a-id_public")+")",function(b){b&&username_editing(a)})}function username_validate(a){return(a||"").toLowerCase().replace(/[\W_]+/g,"")}function username_editing(a,b){if(!email_verified_required(_h("a-id_edit")))return!1;alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-id_edit"),cancel:""+_h("a-no")},buttonReverse:!0}),alertify.prompt('<i class="fal fa-user"></i> '+_h("a-id_new")+'<br><i class="fal fa-info-circle"></i> '+(b||_h("a-id_format")),function(c,b){if(c){if(a==(b=(b||"").trim().toLowerCase())){username_editing(a,_h("a-id_same")),alertify_input_shake();return}if(b.length<4||!isNaN(b)||!/^[a-z0-9]*$/.test(b)){username_editing(a,_h("a-id_invalid")),alertify_input_shake();return}hj_update({action:"username_editing",username:b}).then(function(c){1===c.Status?(msg('<i class="fal fa-check-circle"></i> '+_h("a-id_edited",{$id:b}),'<i class="fas fa-door-open"></i> '+_h("a-id_signout"),signout),setcookie("hearty_account",b,90),hj_update({action:"gform_post",uri:"1FAIpQLScMUCYu17vjPovyr8Ywr9wbgfVxZ7E5FPYvqdpbPdlEw7TMVQ",data:$.param({"entry.1182370364":"[hj_user_id]","entry.847068538":"[hj_username]",emailAddress:"[hj_email]","entry.1353731030":b,"entry.1460125899":new Date().toISOString().split("T")[0],"entry.1757674378":navigator.userAgent||""})}),hj_mixpanel("Profile Update",{action:"Username"}),ga_event_push("Username",{event_category:"Profile Update",event_label:"Username"})):(username_editing(a,_h("a-id_taken",{$id:b})),alertify_input_shake())}).fail(function(){msg()})}},a),alertify_input_custom({type:"search",autocomplete:"off",placeholder:_h("a-id_format"),minlength:4,maxlength:20,onkeyup:"this.value=username_validate(this.value)"},{"letter-spacing":"3px","ime-mode":"disabled"})}function booktitle_editing(a){account_status().then(function(b){1==b.Values.vip?(alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-name-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="fal fa-book"></i> '+_h("a-name-1"),function(b,a){b&&(a=(a||"").trim()).length>0&&hj_update({action:"profile_update",field:"booktitle",data:a}).then(function(b){switch(b.Status){case 1:$("#hj_booktitle").text(a).attr({title:a}),alertify.success('<i class="fal fa-book"></i> '+_h("a-name-3",{$title:a})),hj_mixpanel("Profile Update",{action:"BookTitle"}),ga_event_push("BookTitle",{event_category:"Profile Update",event_label:"BookTitle"});break;case 2:signin_required();break;default:msg()}}).fail(function(){msg()})},(a||"Dear Diary").toString()),alertify_input_custom({placeholder:"eg. "+_h("a-name-4"),maxlength:40},{"letter-spacing":"2px"})):vip_only(_h("a-name-0"))})}function nav_toggle_account(a){var b=$(".account");b.length>0&&($(".nav_toggle_account li").removeAttr("data-active").eq(a).attr("data-active",""),a=b.width()*(a||0),check_browser("Safari")?b.animate({scrollLeft:a},450):b.scrollLeft(a),b.children("div").scrollTop(0))}function export_txt(a){hj_loading(),account_status().then(function(b){if(1==b.Values.vip){if(is_touch_device())return msg('<i class="far fa-desktop"></i> '+_h("a-dl_pc")),hj_loading(!1),export_txt_stats("use_pc_instead"),!1;alertify.set({labels:{ok:'<i class="fas fa-lock"></i> '+_h("a-dl_pwd-2"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt(a||'<i class="far fa-briefcase"></i> '+_h("a-dl_pwd-0"),function(b,a){if(b){if(a.length<6||a.length>20)return export_txt('<i class="far fa-info-circle"></i> '+_h("a-dl_pwd-1")),alertify_input_shake(),export_txt_stats("password_malformatted"),!1;$("<form>",{method:"post",target:"_self",action:location.origin+"/update",enctype:"application/x-www-form-urlencoded",html:$("<input>",{type:"hidden",name:"action",value:"export_txt"}).add($("<input>",{type:"hidden",name:"password",value:a}))}).appendTo("body").submit(),alertify.success('<i class="far fa-arrow-to-bottom"></i> '+_h("a-dl_pwd-3")),$.wait(2e3).then(function(){export_txt_stats("txt_exported"),hj_mixpanel("Posts Exported"),ga_event_push("Posts Exported",{event_category:"Posts",event_label:"Posts Exported"}),msg('<i class="fab fa-wpforms"></i> '+_h("a-dl_pwd-4"),_h("a-ok-1"))})}$.wait(1e3).then(function(){hj_loading(!1)})},""),alertify_input_custom({type:"password",placeholder:_h("a-dl_pwd-1"),autocomplete:"new-password",minlength:6,maxlength:20},{"letter-spacing":"2px"})}else vip_only(_h("a-dl")),hj_loading(!1),export_txt_stats("notice_upgrade")}).fail(function(){msg(),hj_loading(!1)})}function export_txt_stats(a){return hj_update({action:"gform_post",uri:"1FAIpQLSfvmnOWgvwQfBjQIoJeH6EzxLUq62mwcRB7RQeODoWF1oC7Pg",data:$.param({emailAddress:"[hj_email]","entry.1537657449":"[hj_user_id]","entry.1470526977":"[hj_username]","entry.1332414907":a||"","entry.164417788":check_browser()+", "+check_OS(),"entry.657077146":new Date().toISOString().split("T")[0]})})}function vip_only(a){alertify.set({labels:{ok:_h("a-vip_only-3"),cancel:'<i class="fas fa-star"></i> '+_h("a-vip_only-2")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-box-full"></i> '+(a?"\u300C"+a+"\u300D":_h("a-vip_only-0"))+_h("a-vip_only-1"),function(a){a||hj_href("d?plans=1")})}function account_suspend(){alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-ban"></i> '+_h("a-suspend-2")},buttonReverse:!1}),alertify.confirm('<i class="far fa-exclamation-triangle"></i> '+_h("a-suspend-0")+'<br>(<a onclick="$(\'#alertify-ok\').click();username_details()" href="javascript:void(0)">'+_h("a-suspend-1")+"</a>)",function(a){a||open_url("//docs.google.com/forms/d/e/1FAIpQLSfVJkAOUtBdmwXo6Hc7GBoCRnXBk41PRdcutHnHfgkrBBL3oA/viewform?embedded=true&emailAddress="+$("[data-email]").attr("data-email")+"&entry.537131775="+$(".hj_username").attr("title")+"&entry.1511837812="+check_browser()+", "+check_OS())}),hj_vibrate(80)}function signin_history(){hj_update({action:"signin_history"}).then(function(a){if(1==a.Status){var b=a.Values.map(function(a){var b=a.country||"";return 2==b.length&&(b=$("<img>",{src:"//cdn.statically.io/img/flagcdn.com/28x21/"+b.toLowerCase()+".png",title:b})),$("<tr>",{html:$("<td>",{text:_h("a-auth_log-1",{$device:a.device||"",$browser:a.browser||""})}).add($("<td>",{text:a.ip||"",class:"desktop tablet"})).add($("<td>",{html:b,class:"desktop"})).add($("<td>",{text:date_format(a.created,!0)}))}).prop("outerHTML")});alertify.set({labels:{ok:'<i class="fas fa-reply"></i> '+_h("a-back"),cancel:'<i class="fas fa-shield-check"></i> '+_h("a-auth_log-2")},buttonReverse:!0}),alertify.confirm("<h3>"+_h("a-auth_log-0")+"</h3>"+$("<table>",{class:"signin_history",html:b.join("")}).prop("outerHTML"),function(a){a||open_url(_h("a-auth_log-3"))})}})}function voucher_redeem(a){var a=a||getcookie("hearty_voucher")||"",b="Voucher Redeem";alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("a-redeem-1"),cancel:_h("a-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-gift-card"></i> '+_h("a-redeem-0"),function(c,a){c&&((a=(a||"").trim()).length<4?(voucher_redeem(a),alertify_input_shake()):a.toLowerCase()==$(".hj_username").attr("title")?(alertify.set({labels:{ok:_h("a-no"),cancel:'<i class="fas fa-arrow-alt-circle-right"></i> '+_h("a-voucher_vvip-2")},buttonReverse:!0}),alertify.confirm('<img src="//i.hearty.app/i/vvip.png?o=1"><br><br><b>'+_h("a-voucher_vvip-0")+" \u30FD(\u273F\xb4\uFF65\u30EE\uFF65)\uFF89\u2661</b><br>"+_h("a-voucher_vvip-1"),function(a){a||(ga_event_push("add_to_cart",{items:[{item_id:1,item_name:"VIP Premium",item_list_name:"pricing",item_variant:"Prepaid Plan",id:1,name:"VIP Premium",list_name:"pricing",variant:"Prepaid Plan",quantity:12,price:50}]}),fb_event_push(!1,"AddToCart",{content_type:"product",content_name:"VIP Premium",contents:[{id:1,quantity:12}],value:600,num_items:1,currency:"TWD"}),hj_href("//bit.ly/3Jbdfrx"))})):/sheaspire/gi.test(a)?hj_update({action:"gform_post",uri:"1FAIpQLSdUp4rnErJoEynfg60KgLrkF-7r5qzUh8rScViJ5CmGbwEoLg",data:$.param({"entry.1182370364":"[hj_user_id]","entry.847068538":"[hj_username]",emailAddress:"[hj_email]","entry.1353731030":a,"entry.1460125899":new Date((new Date).getTime()+288e5).toISOString().split("T")[0],"entry.1757674378":check_browser()+", "+check_OS()})}).then(function(){msg('<i class="far fa-gift-card"></i> '+h("a-coupon_ok-0",{$coupon:a})+' <i class="far fa-check-circle"></i><br>'+h("a-coupon_ok-1"),'<i class="fas fa-thumbs-up"></i> '+h("a-ok-0"),function(){hj_href("d")}),setcookie("hearty_voucher","",0),hj_mixpanel(b),ga_event_push(b)}).fail(function(){msg()}):$.ajax({url:location.origin+"/gift/"+a,type:"post",dataType:"json",data:{voucher:a},async:!0,xhrFields:{withCredentials:!0}}).then(function(c){switch(c.Status){case 0:msg('<i class="far fa-times-circle"></i> '+_h("a-voucher_invalid"),_h("a-retry"),function(){voucher_redeem(),alertify_input_shake()});break;case 1:msg('<i class="far fa-gift"></i> '+h("a-voucher_ok",{$voucher:a})+' <i class="far fa-check-circle"></i>','<i class="fas fa-thumbs-up"></i> '+h("a-ok-0"),function(){location.reload()}),hj_mixpanel(b),ga_event_push(b);break;default:msg()}}).fail(function(){msg()}))},a),alertify_input_custom({oninput:"this.value=this.value.toUpperCase()",placeholder:_h("a-redeem-0")},{"ime-mode":"disabled","letter-spacing":"2px"})}function hj_preview(e,a){var c=$("body"),b=$(".hj_preview"),d=b.find("iframe");return(a=a||"")&&d.attr({src:a}).addClass("loading"),e?(b.fadeIn(),c.css({"overflow-y":"hidden","touch-action":"none"})):(b.fadeOut(),c.css({"overflow-y":"auto","touch-action":"auto"})),d}function account_linenotify(){hj_update({action:"account_linenotify"}).then(function(a){var b=1==a.Status;alertify.set({labels:{ok:'<i class="fas fa-hand-point-right"></i> '+(b?_h("a-line_set-3"):_h("a-line_set-2")),cancel:_h("a-back")},buttonReverse:!1}),alertify.confirm('<i class="far fa-info-circle"></i> '+(b?_h("a-line_set-1",{$date:date_format(a.Values.created,!0)}):_h("a-line_set-0")+'<br><img src="//i.hearty.app/BfMM4x9.png">'),function(a){a&&(is_touch_device()?open_url("//hearty.app/ln"):hj_preview(!0,"line://ti/p/@uiv1093y").delay(30).queue(function(){$(this).attr({src:"//go.hearty.me/ln"}).dequeue()}))})})}function hj_loading(b){var a=$("body");b?a.addClass("loading"):a.removeClass("loading")}