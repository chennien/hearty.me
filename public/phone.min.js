"use strict";function dial_code(a){var b={AD:376,AE:971,AF:93,AG:1,AI:1,AL:355,AM:374,AO:244,AQ:672,AR:54,AS:1,AT:43,AU:61,AW:297,AX:358,AZ:994,BA:387,BB:1,BD:880,BE:32,BF:226,BG:359,BH:973,BI:257,BJ:229,BL:590,BM:1,BN:673,BO:591,BQ:599,BR:55,BS:1,BT:975,BV:47,BW:267,BY:375,BZ:501,CA:1,CC:61,CD:243,CF:236,CG:242,CH:41,CI:225,CK:682,CL:56,CM:237,CN:86,CO:57,CR:506,CU:53,CV:238,CW:599,CX:61,CY:357,CZ:420,DE:49,DJ:253,DK:45,DM:1,DO:1,DZ:213,EC:593,EE:372,EG:20,EH:212,ER:291,ES:34,ET:251,FI:358,FJ:679,FK:500,FM:691,FO:298,FR:33,GA:241,GB:44,GD:1,GE:995,GF:594,GG:44,GH:233,GI:350,GL:299,GM:220,GN:224,GP:590,GQ:240,GR:30,GS:500,GT:502,GU:1,GW:245,GY:592,HK:852,HM:672,HN:504,HR:385,HT:509,HU:36,ID:62,IE:353,IL:972,IM:44,IN:91,IO:246,IQ:964,IR:98,IS:354,IT:39,JE:44,JM:1,JO:962,JP:81,KE:254,KG:996,KH:855,KI:686,KM:269,KN:1,KP:850,KR:82,KW:965,KY:1,KZ:7,LA:856,LB:961,LC:1,LI:423,LK:94,LR:231,LS:266,LT:370,LU:352,LV:371,LY:218,MA:212,MC:377,MD:373,ME:382,MF:590,MG:261,MH:692,MK:389,ML:223,MM:95,MN:976,MO:853,MP:1,MQ:596,MR:222,MS:1,MT:356,MU:230,MV:960,MW:265,MX:52,MY:60,MZ:258,NA:264,NC:687,NE:227,NF:672,NG:234,NI:505,NL:31,NO:47,NP:977,NR:674,NU:683,NZ:64,OM:968,PA:507,PE:51,PF:689,PG:675,PH:63,PK:92,PL:48,PM:508,PN:870,PR:1,PS:970,PT:351,PW:680,PY:595,QA:974,RE:262,RO:40,RS:381,RU:7,RW:250,SA:966,SB:677,SC:248,SD:249,SE:46,SG:65,SH:290,SI:386,SJ:47,SK:421,SL:232,SM:378,SN:221,SO:252,SR:597,SS:211,ST:239,SV:503,SX:1,SY:963,SZ:268,TC:1,TD:235,TF:262,TG:228,TH:66,TJ:992,TK:690,TL:670,TM:993,TN:216,TO:676,TR:90,TT:1,TV:688,TW:886,TZ:255,UA:380,UG:256,UM:246,US:1,UY:598,UZ:998,VA:379,VC:1,VE:58,VG:1,VI:1,VN:84,VU:678,WF:681,WS:685,YE:967,YT:262,ZA:27,ZM:260,ZW:263};return a in b?b[a]:886}function phone_no_prefill(){var a=getUrlPara("cc")||"",b=$("#country-code");a?b.val(a).find("[value="+a+"]").attr({selected:"selected"}):hj_ip().then(function(a){return a.loc||""}).then(function(c){a=dial_code(c),b.val(a).find("[value="+a+"]").attr({selected:"selected"})}),$("#phone-no").val(getUrlPara("no")||"")}function phone_firebase_init(){window.firebase.auth().onAuthStateChanged(function(a){if(a){var b=$("#country-code").val()||886,c=a.phoneNumber.replace("+"+b,"");hj_update({action:"phone_verification_firebase",cc:b,no:c,token:a.uid}).then(function(d){switch(d.Status){case 1:case 3:hj_update({action:"gform_post",uri:"1FAIpQLSfW2spId3fWb_h31S4jXhv33Vjal-bHGGIAqtXETGhiqjFB0w",data:$.param({"entry.1182370364":"[hj_user_id]","entry.847068538":"[hj_username]",emailAddress:"[hj_email]","entry.1353731030":b,"entry.352107652":c,"entry.1205631750":a.uid,"entry.1460125899":new Date().toISOString().split("T")[0],"entry.1757674378":navigator.userAgent||""})}),window.phone_firebase_result=null,firebase.auth().signOut().then(phone_firebase_verified).catch(function(a){msg(),location.reload(!0)});break;case 2:msg('<i class="far fa-exclamation-triangle"></i> '+_h("pv-signin-0"),'<i class="fas fa-door-open"></i> '+_h("pv-signin-1"),function(){hj_href("?r="+location.href.split("#")[0].split("?")[0].replace(location.origin,"")+"#signin")});break;default:msg()}}).fail(msg),$("#phone-verify-firebase").hide()}}),window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier("phone-firebase",{size:"invisible",callback:phone_firebase}),window.recaptchaVerifier.render().then(function(a){window.recaptchaWidgetId=a}).catch(phone_not_loaded)}function phone_firebase(){var b=$("#country-code").val()||886,c=$("#phone-no"),a=c.val()||"",d=window.recaptchaVerifier;if(a.length<3)return msg('<i class="far fa-exclamation-triangle"></i> '+_h("pv-format-0"),_h("pv-ok"),function(){shake(c.parent()),c.focus()}),resetReCaptcha(),!1;firebase.auth().signInWithPhoneNumber("+"+b+a,d).then(function(a){window.phone_firebase_result=a,phone_firebase_verify("",!0)}).catch(function(a){switch(a.code){case"auth/invalid-phone-number":msg('<i class="far fa-times"></i> '+_h("pv-format-1"),_h("pv-ok"),function(){shake(c),c.focus()});break;case"auth/too-many-requests":msg('<i class="far fa-exclamation-circle"></i> '+_h("pv-format-2")+"<br>"+a.message);break;default:msg('<i class="far fa-exclamation-circle"></i> '+a.code+"<br>"+a.message)}resetReCaptcha()})}function phone_firebase_verify(c,d){var a=$("#phone-verify-firebase");if(!window.phone_firebase_result)return a.prop("disabled",!0).show(),!1;alertify.set({labels:{ok:'<i class="fas fa-check-circle"></i> '+_h("pv-verify1-0"),cancel:_h("pv-no")},buttonReverse:!1}),alertify.prompt('<i class="far fa-mobile"></i> '+_h("pv-verify1-1")+(d?_h("pv-verify1-2"):""),function(c,b){if(c){if((b=b||"").length<6)return msg('<i class="far fa-exclamation-circle"></i> '+_h("pv-code-2"),_h("pv-code-1"),function(){phone_firebase_verify()}),!1;phone_firebase_result.confirm(b).then(function(a){a.user,msg('<i class="fas fa-check-circle"></i> '+_h("pv-verify1-3",{$no:$("#phone-no").val()}),_h("pv-ok"))}).catch(function(b){switch(b.code){case"auth/invalid-verification-code":msg('<i class="far fa-times"></i> '+_h("pv-code-3"),_h("pv-code-1"),function(){phone_firebase_verify()});break;case"auth/code-expired":msg('<i class="far fa-times"></i> '+_h("pv-code-4")+"<br>"+b.message),window.phone_firebase_result=null,a.hide();break;default:msg('<i class="far fa-exclamation-circle"></i> '+b.code+"<br>"+b.message)}})}},(c||"").toString()),alertify_input_custom({type:"tel",placeholder:_h("pv-code-0"),minlength:1,maxlength:6,onkeyup:"if(this.value.length==6)$('.alertify-button-ok').click()"},{"letter-spacing":"3px"}),a.removeAttr("disabled").show();var b=$("#phone-firebase");b.finish().prop("disabled",!0).text(b.attr("data-wait")).delay(3e4).queue(function(){$(this).removeAttr("disabled").text($(this).attr("data-text")).dequeue()}),is_touch_device()&&$("[data-unreceived]").delay(3e4).queue(function(){$(this).show().dequeue()})}function phone_not_loaded(){msg(hj_lang_zhcn()?'<i class="fal fa-signal-slash"></i> \u5728\u4E2D\u56FD\uFF0C\u8C37\u6B4C\u56FD\u9645\u77ED\u4FE1\u9A8C\u8BC1\u529F\u80FD\u88AB\u7246\u4E86':'<i class="fal fa-exclamation-triangle"></i> '+_h("pv-fail")," \u03A3\u30FD(\uFF9F\u0414 \uFF9F; )\uFF89 ")}function resetReCaptcha(){"undefined"!=typeof grecaptcha&& void 0!==window.recaptchaWidgetId&&grecaptcha.reset(window.recaptchaWidgetId)}function phone_firebase_verified(){/8(1|86)|66/.test($("#country-code").val())?(alertify.set({labels:{ok:_h("pv-no"),cancel:'<i class="fas fa-hand-point-right"></i> '+_h("pv-ok")},buttonReverse:!0}),alertify.confirm('<i class="fab fa-line"></i> '+_h("pv-line"),function(a){hj_href("account"+(a?"":"?line=1"))})):hj_href("account")}function phone_manual_verify(a){alertify.set({labels:{ok:_h("pv-no"),cancel:'<i class="fas fa-comment-alt-dots"></i> '+_h("pv-verify2-2")},buttonReverse:!0}),alertify.confirm('<i class="fal fa-question-circle"></i> '+_h("pv-verify2-0")+"<br>"+_h("pv-verify2-1"),function(b){b||(location.href="sms:+886902290532"+(check_OS("iOS")?"&":"?")+"body="+encodeURIComponent(_h("pv-verify2-4"))+(a||"")+" ",setTimeout(function(){msg('<i class="fal fa-info-circle"></i> '+_h("pv-verify2-3"),_h("pv-ok"),function(){hj_href("account")})},7e3),fb_event_push(!1,"Contact"))})}Sentry.init({dsn:"https://a6cb9b2263814097b85a2170900e6d62@sentry.io/183684"}),Bugsnag.start({apiKey:"5c55b919bc2a4ed35ffa675c9341251c",appType:"client"}),$(function(){window.firebase?phone_firebase_init():phone_not_loaded(),phone_no_prefill(),$("[data-unreceived]").on("click",function(){phone_manual_verify(this.dataset.username)}),$("[data-goback]").on("click",function(){hj_href("account")}),document.title=_h("pv-title")+" | \u{1F49D} Hearty Journal \u6EAB\u5EA6\u65E5\u8A18"})