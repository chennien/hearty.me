"use strict";function nav_toggle_feed(e){var t=$(".feed");if(e=e||0,t.length>0){var a=t.width()*e;check_browser("Safari")?t.animate({scrollLeft:a},450):t.scrollLeft(a)}}function read_post(e){var t=Number(e.post_id)||0;$.ajax({url:location.href,type:"post",data:{action:"read",post_id:t},async:!0,dataType:"json"}).then(function(a){switch(a.Status){case 1:a=a.Values;var i=$(".page .story"),n=i.find("article");n.find("h2").attr({title:a.title}),n.find("p").text(a.post),n.find(".published").attr({title:a.published}),i.find(".avatar").attr({"data-username":e.username,"data-post_id":t,title:e.nickname}).find("div").attr({style:"background-image: url('//i0.wp.com/hearty.me/uploads/images/users/"+e.profile_image+"');"}),$(".page .illustration").hide(),i.fadeOut("fast",function(){$(this).slideDown("fast",function(){$(this).scrollTop(0)})}),$(".feed_wall article").removeAttr("data-active").filter("[data-post_id='"+t+"']").attr("data-active","");break;default:msg()}}).fail(function(){msg()}),nav_toggle_feed(1)}function focus_active_post(){nav_toggle_feed(0);var e=$(".feed_wall article[data-active]");"scrollIntoView"in document.documentElement&&e.length>0&&e.get(0).scrollIntoView(),e.delay(400).queue(function(){shake($(this)),$(this).dequeue()})}function bookmark(e,t){hj_update({action:"bookmark",post_id:e}).then(function(t){switch(t.Status){case 1:hj_vibrate(80),hj_mixpanel("Post Bookmarked",{post_id:e}),ga_event_push("Bookmark",{event_category:"Posts",event_label:"Bookmark"});break;case 2:alertify.set({labels:{ok:"<i class='fas fa-sign-in-alt'></i> 登入",cancel:"取消"},buttonReverse:!1}),alertify.confirm("<i class='fal fa-door-open'></i> 登入以使用完整功能",function(e){e&&(window.top.location.href=location.origin+"/#signin?r=/feed")})}}),t.toggleClass("fal fas")}function navigate_journal(e,t,a){alertify.set({labels:{ok:"<i class='fas fa-hand-point-right'></i> 走吧",cancel:"取消"},buttonReverse:!1}),alertify.confirm("<i class='fal fa-book-alt'></i> 前往「"+a+"」的日記本",function(a){a&&open_url(location.origin+"/"+e+"/"+t)})}function how2contribute(){alertify.set({labels:{ok:"<i class='fas fa-hand-point-right'></i> 我的日記本",cancel:"好的"},buttonReverse:!1}),alertify.confirm("<h3><i class='fal fa-info-circle'></i> 如何投稿</h3>在日記中，點選【 <i class='fal fa-share-alt'></i> 】可投稿文章",function(e){e&&(location.href=location.origin+"/d")})}$(function(){window.ias=new InfiniteAjaxScroll(".feed_wall",{scrollContainer:".feed_wall",item:".article",next:".pager_next",pagination:".pager",spinner:{element:".bouncingLoader",delay:600}}),ias.on("page",e=>{document.title=e.title,history.replaceState(history.state,e.title,e.url)}),ias.on("appended",e=>{0==e.items.length&&$(".no_more").fadeIn()}),PullToRefresh.init({mainElement:".feed_wall",triggerElement:".feed_wall",instructionsRefreshing:"刷新中",instructionsPullToRefresh:"下拉刷新",instructionsReleaseToRefresh:"放開以刷新",distIgnore:150,onRefresh:function(){location.href=location.origin+"/feed?p=1"}}),$(".page .story").hide()});