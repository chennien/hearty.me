"use strict";var _h$=_h$||{};_h$.f={refresh:"Êõ¥Êñ∞‰∏≠",refresh_pull:"‰∏ãÊãâÂà∑Êñ∞",refresh_release:"ÊîæÈñã‰ª•Âà∑Êñ∞",sigin:"ÁôªÂÖ•",cancel:"ÂèñÊ∂à",plzsignin:"ÁôªÂÖ•‰ª•‰ΩøÁî®ÂÆåÊï¥ÂäüËÉΩ",copyurl:"Ë§áË£ΩÁ∂≤ÂùÄ",qrcode:"ÊñáÁ´†Á∂≤ÂùÄ/QRcode",publish1:"Â¶Ç‰ΩïÊäïÁ®ø",publish2:"Âú®Êó•Ë®ò‰∏≠ÔºåÈªûÈÅ∏",publish3:"ÂèØÊäïÁ®øÊñáÁ´†",publish_ok:"Â•ΩÁöÑ",publish_diary:"ÊàëÁöÑÊó•Ë®òÊú¨",report_ask:"Ê™¢ËàâÊñáÁ´†„Äå$title„ÄçÂóéÔºü",report_yes:"ÊòØÁöÑÔºå‰ªñÊòØÂ£û‰∫∫",report_thx:"Ë¨ùË¨ùÊÇ®Ê™¢Ëàâ„Äå$title„ÄçÔºåÂ∞áÁî±Ê∫´Â∫¶Â∞èÁ∑®ÂØ©Èñ±",menu:"‰∏ªÈÅ∏ÂñÆ",share:"ËΩâÂàÜ‰∫´",report:"Ê™¢ËàâÊñáÁ´†",focus_post:"È°ØÁ§∫ÊñºÂãïÊÖã",publish:"ÊäïÁ®ø",gotop:"ÂõûÂà∞‰∏äÈù¢",goback:"ËøîÂõû"};var btn_alias="feed";function feed_hotkey_init(){is_touch_device()||$(document).on("keydown",function(e){var t=e.keyCode,a=$(".feed_wall"),n=a.find("article");38!=t&&40!=t||(e.preventDefault(),n.length>0&&((n=(38==t?n.filter("[data-active]").prev().get(0):n.filter("[data-active]").next().get(0))||n.eq(0).get(0)).click(),a.scrollTop(n.offsetTop||a.get(0).scrollHeight)))})}function feed_scrolltop(e){e=e||$("html,body"),check_browser("Safari")?e.stop().animate({scrollTop:0},450):e.stop().scrollTop(0)}function hj_feed_history_init(){$("body").width()<1025&&"function"==typeof history.pushState&&(hj_feed_history_push(),window.addEventListener("popstate",function(){var e=$(".page .story"),t=$(".feed").scrollLeft();$(".feed .profile").is(":visible")?(profile_popup(),hj_feed_history_push()):e.is(":visible")?(nav_toggle_feed(+(0==t)),t>0?e.delay(500).queue(function(){$(this).hide().dequeue()}):e.show(),hj_feed_history_push()):hj_href("d"),null!=$("nav.menu").data("mmenu")&&$("nav.menu").data("mmenu").close()},!1))}function hj_feed_history_push(){history.pushState(null,document.title,location.href)}function nav_toggle_feed(e){var t=$(".feed");if(e=e||0,t.length>0){var a=t.width()*e;check_browser("Safari")?t.animate({scrollLeft:a},450):t.scrollLeft(a)}}function read_post(e){var t=Number(e.post_id)||0,a=$(".page .story"),n=a.find("article"),i=is_touch_device();i||a.fadeOut("fast"),$.ajax({url:location.href,type:"post",data:{action:"read",post_id:t},async:!0,dataType:"json"}).then(function(o){switch(o.Status){case 1:o=o.Values,n.find("h2").attr({title:o.title}),document.title=o.title+" | üíù Ê∫´Â∫¶Êó•Ë®ò Hearty Journal",n.find("p").html(linkify((o.post||"").trim())),n.find(".published").attr({title:o.published}),n.attr({"data-username":e.username,"data-post_id":t}).find(".avatar").attr({title:e.nickname,"data-profile_image":e.profile_image,"data-gender":e.gender}).find("div").css({"background-image":"url('//i.hearty.app/u/"+e.profile_image+(webp_support()?"":"?o=1")+"')"}),$(".page .illustration").hide(),i?a.show().scrollTop(0):a.slideDown("fast",function(){$(this).scrollTop(0)}),$(".feed_wall article").removeAttr("data-active").filter("[data-post_id='"+t+"']").attr("data-active","");break;default:nav_toggle_feed(0)}}).fail(function(){msg()}),nav_toggle_feed(1)}function linkify(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\b(?:https):\/\/(|(\w+)\.)(hearty\.(me|app|gift|tw|page\.link|eu\.org)|hj\.rs|ht\.mk|nien\.(co(m|)|org))(\/(\S+)?|)/gim,'<a target="_blank" href="$&" rel="ugc" title="$&">$&</a>').replace(/((?!([\(])).|^|\s)#(\S+)(?![^<]*>|[^<>ÔΩõÔΩù]*<\/)/g,'$1<a title="$3" onclick="msg(\'#$3\')">#$3</a>').replace(/[^\S\r\n]?\*([^\*{}=#<>ÔΩõÔΩù]+)\*[^\S\r\n]?(?![^<]*>|[^<>]*<\/)/g,'<mark title="$1">$1</mark>').replace(/[^\S\r\n]?[{|ÔΩõ]([^\*{}=#<>ÔΩõÔΩù]+)[}|ÔΩù][^\S\r\n]?(?![^<]*>|[^<>]*<\/)/g,'<u title="$1">$1</u>').replace(/[^\S\r\n]?=([^\*{}=#<>ÔΩõÔΩù]+)=[^\S\r\n]?(?![^<]*>|[^<>]*<\/)/g,'<u title="$1" data-double>$1</u>')}function focus_active_post(e){nav_toggle_feed(0);var t=$(".feed_wall article"+(null==e?"[data-active]":"[data-post_id='"+e+"']"));return"scrollIntoView"in document.documentElement&&t.length>0&&t.get(0).scrollIntoView(),t.delay(400).animate({zoom:1.1},300,function(){$(this).animate({zoom:1},300),hj_vibrate(30)}),t}function bookmark(e,t){hj_update({action:"bookmark",post_id:e}).then(function(t){switch(t.Status){case 1:hj_mixpanel("Post Bookmarked",{post_id:e}),ga_event_push("Bookmark",{event_category:"Posts",event_label:"Bookmark"});break;case 2:alertify.set({labels:{ok:"<i class='fas fa-sign-in-alt'></i> "+_h("f-signin"),cancel:_h("f-cancel")},buttonReverse:!1}),alertify.confirm("<i class='fal fa-door-open'></i> "+_h("f-plzsignin"),function(e){e&&hj_href("#signin?r=/feed")})}}),t.toggleClass("fal fas")}function profile_popup(e,t,a,n,i){var o=$(".feed .profile");null==e?o.fadeOut("fast"):(o.find("[data-a]").css({"background-image":"url('//i.hearty.app/u/"+a+(webp_support()?"":"?o=1")+"')"}),o.find("[data-n]").attr({title:t,"data-gender":n}),o.find("[data-penpal_add]").attr({"data-username":e}),o.fadeIn("fast"))}function feed_share_this(e,t){var a="https://hearty.app/"+e+"/"+t+"?st="+encodeURIComponent($(".story h2").attr("title")||"");"share"in navigator?navigator.share({title:document.title,url:a}).catch(e=>{console.log("Error ",e)}):!1!==check_hjapp()?location.assign("//hearty.me/wv?s="+encodeURIComponent(a.replace(/(^\w+:|^)\/\//,""))):(alertify.set({labels:{ok:_h("f-cancel"),cancel:"<i class='fas fa-copy'></i> "+_h("f-copyurl")},buttonReverse:!0}),alertify.prompt('<i class="fal fa-file-alt"></i> '+_h("f-qrcode")+'<br><br><a class="qrcode"></a>',function(e){e||hj_copy($("#alertify .alertify-text"))},a),alertify_input_custom({type:"url",placeholder:a,onclick:"hj_copy($(this))"},{cursor:"copy"}),get_qrcode($("#alertify .qrcode"),a)),hj_copy_text(a)}function how2publish(){alertify.set({labels:{ok:"<i class='fas fa-hand-point-right'></i> "+_h("f-publish_diary"),cancel:_h("f-publish_ok")},buttonReverse:!1}),alertify.confirm("<h3><i class='fal fa-info-circle'></i> "+_h("f-publish1")+"</h3>"+_h("f-publish2")+"„Äê <i class='fal fa-share-alt'></i> „Äë"+_h("f-publish3"),function(e){e&&hj_href("d")})}function report_abuse(e){account_status().then(function(t){if(1==t.Status){var a=$(".page .story article"),n=(a.find("h2").attr("title")||"ÁÑ°Ê®ôÈ°å").trim();alertify.set({labels:{ok:_h("f-cancel"),cancel:"<i class='fas fa-check-circle'></i> "+_h("f-report_yes")},buttonReverse:!1}),alertify.confirm("<i class='fal fa-flag-alt'></i> "+_h("f-report_ask",{$title:n}),function(t){t||hj_update({action:"gform_post",uri:"1FAIpQLSdPi8fPhBq6KN1ok8h6fK8h5At0SO0qANuNlDCNk6VDoVjjuA",data:$.param({"entry.783049182":"[hj_user_id]","entry.866865386":"[hj_username]",emailAddress:"[hj_email]","entry.527303026":"ÊäïÁ®øÊó•Ë®ò (ÈÅ≠Ê™¢Ëàâ)","entry.355700800":e,"entry.1592095357":(a.find("p").text()||"n/a").trim(),"entry.1259076046":(new Date).toISOString().split("T")[0],"entry.124585191":check_browser()+", "+check_OS()})}).then(function(t){switch(t.Status){case 1:msg("üìù "+_h("f-report_thx",{$title:n})),hj_mixpanel("Feed Post Reported",{post_id:e}),ga_event_push("Feed Post Reported",{event_category:"Posts",event_label:"Comment Reported"})}})})}else msg("<i class='fal fa-door-open'></i> "+_h("f-plzsignin"))})}function feed_translate(){(navigator.language||"").toLowerCase().indexOf("zh")<0&&hj_getScript("//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit")}function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"zh-TW",includedLanguages:"en,jp,zh-TW,ja,ko",layout:google.translate.TranslateElement.InlineLayout.SIMPLE,autoDisplay:!1},"google_translate_element")}hj_getScript("//cdn.jsdelivr.net/combine/npm/@webcreate/infinite-ajax-scroll@3.0.0-beta.6/dist/infinite-ajax-scroll.min.js,npm/pulltorefreshjs@0.1.22/dist/index.umd.min.js").then(function(){$(function(){post_font();var e=new InfiniteAjaxScroll(".feed_wall",{scrollContainer:".feed_wall",item:".article",next:".pager_next",pagination:".pager",spinner:{element:".bouncingLoader",delay:600}});e.on("page",function(e){document.title=e.title,history.replaceState(history.state,e.title,e.url)}),e.on("appended",function(e){e.items.length||$(".no_more").fadeIn()}),PullToRefresh.init({mainElement:".feed_wall",triggerElement:".feed_wall",instructionsRefreshing:_h("f-refresh"),instructionsPullToRefresh:_h("f-refresh_pull"),instructionsReleaseToRefresh:_h("f-refresh_release"),distIgnore:200,onRefresh:function(){hj_href("feed?p=1")}});var t=Number(getUrlPara("post")||0);t>0&&focus_active_post(t).attr("data-active",""),$(".page .story").scroll(function(){var e=$(".nav_btn.fa-chevron-up");$(this).scrollTop()>200?e.stop().fadeIn("slow"):e.stop().fadeOut("slow")}).hide(),$(".mh-head .left").on("click",function(){nav_toggle($(".menu"),!0)}),$(".page_back").on("click",function(){nav_toggle_feed(0)}),$(".nav_btn.fa-plus, .page_publish").on("click",how2publish),$(".nav_btn.fa-chevron-up").on("click",function(){feed_scrolltop($(".page .story"))}).hide(),$("[data-focus_post]").on("click",function(){focus_active_post()}),$(".profile").on("click",function(){profile_popup()}),feed_translate(),feed_hotkey_init(),hj_feed_history_init()})}),leave_InAppBrowser();