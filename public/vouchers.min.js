"use strict";function bd_loading(b){var a=$("body");b?a.addClass("loading"):a.removeClass("loading")}function bd_update(a){return $.ajax({url:location.origin+"/bd/update.php",type:"post",crossDomain:!0,dataType:"json",data:a,async:!0,xhrFields:{withCredentials:!0}})}function get_vouchers(){bd_update({action:"get_vouchers"}).then(function(a){1===a.Status?($(".vouchers tbody[data-empty] tr").remove(),list_vouchers(a.Values)):msg()}).fail(function(){msg()})}function list_vouchers(a){var b=$(".vouchers tbody").hide();a.forEach(function(a){var c=$("[data-sample] tr").clone().removeAttr("data-sample");if(c.find("[data-voucher]").attr({title:a.voucher}),c.find("[data-expiration]").attr({"data-expiration":a.expiration[0],title:a.expiration[1]}),"email"in a&&c.find("[data-email]").attr({title:a.email,"data-emails_sent":a.emails_sent}),"remark"in a&&c.find("[data-remark]").attr({title:a.remark}),"redemption"in a){var d=parseInt(a.expired)>0,e=parseInt(a.redemption)>0;c.find("[data-status]").attr({"data-status":e?2:+!d,title:e?"\u5DF2\u514C\u63DB":d?"\u903E\u671F":"\u6709\u6548"})}c.prependTo(b)}),b.fadeIn()}function voucher_remark(a){if(a){var c=a.siblings("[data-voucher]").attr("title")||"",b=a.attr("title")||"";alertify.set({labels:{ok:'<i class="fas fa-plus"></i> \u8CBC\u4E0A',cancel:"\u53D6\u6D88"},buttonReverse:!1}),alertify.prompt('<i class="fal fa-edit"></i> \u5099\u8A3B\u4E00\u4E0B\uFF1A',function(d,b){d&&bd_update({action:"voucher_remark",voucher:c,remark:b=b||""}).then(function(c){1==c.Status&&a.attr({title:b})}).fail(function(){msg()})},b),alertify_input_custom({minlength:1,max:20,placeholder:"eg. \u9818\u53D6\u8005\u59D3\u540D\u3001\u6A94\u671F\u540D\u7A31\u3001\u5176\u4ED6\u8CC7\u8A0A"},{"letter-spacing":"1px"})}}function create_vouchers(){alertify.set({labels:{ok:'<i class="fas fa-shopping-bag"></i> \u53D6\u865F',cancel:"\u5426"},buttonReverse:!1}),alertify.prompt('<i class="fal fa-gift"></i> \u9700\u8981\u5E7E\u5F35\u5E8F\u865F\u5462\uFF1F<br><small>\u5E8F\u865F\u9700\u65BC 7\u65E5\u5167\u514C\u63DB\u5B8C\u7562\uFF0C\u8ACB\u7D22\u53D6\u6240\u9700\u6578\u91CF\u5373\u53EF</small>',function(b,a){b&&bd_update({action:"create_vouchers",num:a=Math.min(a||1,20)}).then(function(a){1===a.Status?list_vouchers(a.Values):msg()}).fail(function(){msg()})},"1"),alertify_input_custom({type:"number",min:1,max:20,step:1,maxlength:3,placeholder:10},{"letter-spacing":"3px"})}function hide_voucher(a){var b=a.siblings("[data-voucher]").attr("title")||"",c=1==a.siblings("[data-status]").attr("data-status");alertify.set({labels:{ok:"\u5426",cancel:'<i class="fas fa-trash-alt"></i> \u522A\u6389\u5B83'},buttonReverse:!1}),alertify.confirm('<i class="fal fa-exclamation-circle"></i> '+(c?"\u5E8F\u865F\u672A\u88AB\u514C\u63DB\uFF0C\u4E0D\u518D\u9700\u8981":"\u522A\u9664\u7528\u904E\u7684")+"\u300C"+b+"\u300D\u55CE\uFF1F",function(c){c||bd_update({action:"hide_voucher",voucher:b}).then(function(c){1===c.Status?(alertify.error('<i class="fas fa-trash-alt"></i> \u522A\u9664\u4E86 '+b),a.parent().slideUp("slow",function(){$(this).remove()}),hj_vibrate(30)):msg()}).fail(function(){msg()})})}function collect_email(a){if(a){var d=a.siblings("[data-voucher]").attr("title")||"",b=(a.attr("title")||"").toLowerCase(),c=a.attr("data-emails_sent")||0,e=a.siblings("[data-expiration]").attr("data-expiration");c<0?msg('<i class="fal fa-ban"></i> '+b+" \u5DF2\u9000\u8A02\u901A\u77E5\u4FE1\uFF0C\u5225\u518D\u5BC4\u7D66\u4ED6\u60F9"):0==c?(alertify.set({labels:{ok:'<i class="fas fa-chevron-right"></i> \u4E0B\u4E00\u6B65\uFF0C\u8A2D\u5B9A Email',cancel:"\u5426"},buttonReverse:!1}),alertify.prompt('<i class="fal fa-envelope"></i> \u6536\u4EF6\u4EBA Email\uFF1A<br><small><i class="far fa-shield-alt"></i> \u57FA\u65BC\u500B\u8CC7\u4FDD\u8B77\uFF0C\u65BC\u6B64\u767B\u9304\u4E4B\u6C11\u773E Email\uFF0C\u5C07\u52A0\u4EE5\u4FDD\u5BC6\uFF0C<br>\u50C5\u7531\u8CB4\u5E97\u7684\u60A8\u7528\u65BC\u672C\u6B21\u901A\u77E5\uFF0C\u4E0D\u6703\u4E5F\u7121\u6CD5\u79FB\u4F5C\u5176\u4ED6\u7528\u9014</small>',function(f,c){f&&(b==(c=(c||"").trim())?email_composer(!0,d,b,e):c.length>5?(email_composer(!0,d,c,e),bd_update({action:"voucher_email",voucher:d,email:c}).then(function(b){switch(b.Status){case 1:a.attr({title:c});case 3:msg('<i class="fal fa-times"></i> Email \u6709\u8AA4\uFF0C\u6216\u683C\u5F0F\u4E0D\u6B63\u78BA'),collect_email(a);break;case 4:msg('<i class="fal fa-ban"></i> '+c+" \u5DF2\u9000\u8A02\u901A\u77E5\u4FE1\uFF0C\u5225\u518D\u5BC4\u7D66\u4ED6\u60F9"),collect_email(a);break;default:msg()}email_composer(!1)}).fail(function(){msg(),email_composer(!1)})):(alertify_input_shake(),collect_email("")))},b),alertify_input_custom({type:"email",min:5,max:64,placeholder:"someone@gmail.com"},{"letter-spacing":"1px"})):email_composer(!0,d,b,e)}}function email_composer(e,f,b,h){var c=$(".email"),a=c.find(".variables"),g=$("#Smallchat");if(e){c.removeAttr("data-hidden").fadeTo("fast",1).find("input[type='email']").val(b),a.find("[data-voucher-email]").attr("data-voucher-email",b),a.find("[data-voucher-timer]").attr("data-voucher-timer",h);var d="https://hearty.gift/"+f+"/"+b;a.find("[data-voucher]").attr({href:d,"data-voucher":f,rel:"noopener"}),a.find("[data-voucher-link]").attr({href:d,"data-voucher-link":d,rel:"noopener"}),hj_tinymce_init(),g.fadeOut()}else c.fadeOut(),g.fadeIn();$("body").css({overflow:e?"hidden":"auto"})}function send_voucher_email(){var d=hj_template_field("voucher"),a=hj_template_field("voucher-email"),b=$("[data-emails_sent][title='"+a+"']"),c=parseInt(b.attr("data-emails_sent"))||0;if(a.length<5||0>a.indexOf("@")){msg('<i class="fal fa-info-circle"></i> Email \u683C\u5F0F\u4E0D\u6B63\u78BA');return}if(c>4){msg('<i class="fal fa-exclamation-triangle"></i> \u8D85\u51FA\u767C\u4FE1\u4E0A\u9650 (5\u5C01/\u55AE\u4E00\u6536\u4EF6\u4EBA)\uFF0C\u8ACB\u806F\u7D61\u6EAB\u5EA6\u5718\u968A');return}alertify.set({labels:{ok:"\u78BA\u8A8D\u5BC4\u51FA",cancel:"\u53D6\u6D88"},buttonReverse:!1}),alertify.confirm('<i class="fal fa-eye-slash"></i> \u5373\u5C07\u767C\u9001\u5E8F\u865F\u901A\u77E5\u4FE1\u5230\u300C'+a+"\u300D",function(f){if(f){bd_loading(!0);var e=$("<i>",{html:tinymce.activeEditor.getContent({format:"raw"})||""});e.find("[data-voucher]").text(e.find("[data-voucher]").attr("data-voucher")).removeAttr("data-voucher"),e.find("[data-voucher-email]").text(e.find("[data-voucher-email]").attr("data-voucher-email")).removeAttr("data-voucher-email"),e.find("[data-voucher-link]").text(e.find("[data-voucher-link]").attr("data-voucher-link")).removeAttr("data-voucher-link"),e.append($("<hr>").add($("<span>",{text:"\u60A8\u53C3\u52A0\u4E86\u54C1\u724C\u6D3B\u52D5\uFF0C\u624D\u6703\u6536\u5230\u6B64\u5C01\u901A\u77E5("+a+")\u3002\u5982\u4E0D\u60F3\u518D\u6536\u5230\uFF0C\u8ACB ",style:"font-size:x-small"})).add($("<a>",{target:"_blank",href:"https://hearty.gift/u/"+a+"/"+d,text:"[\u53D6\u6D88\u8A02\u95B1 Unsubscribe :( ]",rel:"noopener",style:"text-decoration:none;font-size:x-small"})).add($("<img>",{src:"https://www.google-analytics.com/collect?v=1&t=event&tid=UA-26998803-8&cid=b0ed2542-fa8f-4054-82c2-924e6b97cf7d&ec=voucher_email&ea=open&dt=voucher_email&cn=voucher_email&cm="+a+"&cs=voucher_email",width:1,height:1}))).find("a[href*='https://']").each(function(){$(this).attr({href:$(this).attr("href").replace(/https:\/\/(?!c.heartymail)/gi,"https://c.heartymail.com/voucher/"+a+"/"+d+"/")})});var g=e.html(),h=$("textarea[name='subject']").val().trim();bd_update({action:"send_voucher_email",voucher:d,email:a,cc_me:+$("input[name='cc_me']").prop("checked"),subject:h,body:g}).then(function(d){switch(d.Status){case 1:msg('<i class="fas fa-check-circle"></i> \u901A\u77E5\u4FE1\u5DF2\u5BC4\u81F3\uFF1A'+a+"<br><br><img src='//i.hearty.app/w/hearty.me/bd/images/cute_envelope.gif' style='filter:hue-rotate(145deg)saturate(.9)'>"),tinymce.activeEditor.windowManager.close(),email_composer(!1),b.attr({"data-emails_sent":c+1}),hj_update({action:"gform_post",uri:"1FAIpQLScJfg6TYfg_8NwI5d8yGP6H2Az29K9LA3osLnUcKj9YwUJb6Q",data:$.param({emailAddress:a,"entry.768310548":"[hj_user_id]","entry.2003480077":"[hj_username]","entry.1845355844":h,"entry.2038456161":g,"entry.1240071619":new Date().toISOString().split("T")[0],"entry.390259802":check_browser()+", "+check_OS()})});break;case 3:msg('<i class="fal fa-info-circle"></i> Email \u6709\u8AA4\uFF0C\u6216\u683C\u5F0F\u4E0D\u6B63\u78BA');break;default:msg('<i class="fal fa-info-circle"></i> \u7CDF\u4E86\uFF0C\u919C\u4E00\uFF1A'+JSON.stringify(d.Values))}bd_loading(!1)}).fail(function(){msg(),bd_loading(!1)})}}),tinymce.activeEditor.execCommand("mcePreview")}function sender_info(){alertify.set({labels:{ok:"\u597D\u7684",cancel:'<i class="fas fa-edit"></i> \u6211\u8981\u4FEE\u6539'},buttonReverse:!1}),alertify.confirm('<i class="fal fa-mailbox"></i> Email \u524D\u7DB4 = \u6EAB\u5EA6 ID\uFF1B\u986F\u793A\u540D\u7A31 = \u6EAB\u5EA6\u66B1\u7A31',function(a){a||hj_href("account")})}function get_link(b){if(b){var c=b.siblings("[data-voucher]").attr("title")||"",d=b.siblings("[data-email]").attr("title")||null,a="https://hearty.gift/"+c+(null==d?"":"/"+d);alertify.set({labels:{ok:'\u4E0B\u8F09 <i class="fas fa-qrcode"></i>',cancel:'<i class="fas fa-copy"></i> \u8907\u88FD\u9023\u7D50'},buttonReverse:!0}),alertify.prompt('<i class="fal fa-link"></i> \u5C08\u5C6C\u9080\u8ACB\u9023\u7D50\u53CA QRcode<br><br><a class="qrcode"></a>',function(b){b?$("#alertify .qrcode").get(0).click():(hj_copy($("#alertify .alertify-text")),is_touch_device()&&"share"in navigator&&navigator.share({url:a}).catch(function(a){}))},a),alertify_input_custom({type:"url",placeholder:a,onclick:"hj_copy($(this))"},{cursor:"copy"}),hj_copy_text(a),get_qrcode($("#alertify .qrcode"),a,c)}}function hj_tinymce_init(){window.tinymce?hj_tinymce_template():(hj_getScript("//cdn.jsdelivr.net/combine/npm/tinymce@5.10.5/tinymce.min.min.js,npm/tinymce@5.10.5/jquery.tinymce.min.min.js").then(function(){var a=$("textarea[data-editor]");a.val(linkify(a.val())).tinymce({base_url:"https://cdn.jsdelivr.net/npm/tinymce@5.10.5",placeholder:"Email \u4FE1\u4EF6\u5167\u6587",content_css:"https://cdn.jsdelivr.net/gh/chennien/hearty.me@4/public/plugins/vouchers.tinymce.min.css",content_css_cors:!0,statusbar:!1,branding:!1,relative_urls:!1,remove_script_host:!1,height:300,menubar:!1,image_caption:!0,save_enablewhendirty:!1,plugins:"autolink preview directionality code visualblocks visualchars fullscreen image link codesample table charmap toc advlist imagetools textpattern noneditable charmap emoticons table paste save",toolbar:"reset-to-default save code preview fullscreen | image table link | undo redo | bold underline alignjustify aligncenter alignright | forecolor backcolor formatselect removeformatk | emoticons | fontsizeselect",toolbar_drawer:"sliding",link_list:[{title:"\u6EAB\u5EA6\u65E5\u8A18",value:"https://go.hearty.me/hj"}],image_list:[{title:"\u6EAB\u5EA6\u65E5\u8A18 \u4FE1\u982D\u5716\u7247",value:"https://i.hearty.app/i/mailheader.png?o=1"},{title:"\u6EAB\u5EA6\u65E5\u8A18 Logo PNG",value:"https://i.hearty.app/i/logo.png?o=1"},{title:"\u6EAB\u5EA6\u65E5\u8A18 Logo JPG",value:"https://i.hearty.app/i/logo.jpg?o=1"},{title:"\u6EAB\u5EA6\u65E5\u8A18 Sheara",value:"https://i.hearty.app/i/illustrations/sheara.jpg?o=1"}],color_map:["ffffff","\u6F54\u767D","ffd1a4","\u819A\u8272","ffdcdc","\u6DE1\u7C89","ffbdbd","\u6DFA\u7C89","f16d6e","\u6DF1\u7D05","d78b7b","\u5361\u5176","d28064","\u5361\u5176","b4b4b4","\u6DFA\u7070","444444","\u6DF1\u7070","000000","\u7D14\u9ED1"],contextmenu:"link",language:"zh_TW",language_url:"//cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.5/langs/zh_TW.min.js",default_link_target:"_blank",link_default_protocol:"https",paste_retain_style_properties:"all",paste_word_valid_elements:"*[*]",paste_convert_word_fake_lists:!1,paste_webkit_styles:"all",paste_merge_formats:!0,paste_data_images:!0,automatic_uploads:!0,images_upload_url:"../api/mail.img.php",images_upload_credentials:!0,save_onsavecallback:hj_tinymce_template_save,setup:function(a){a.on("init",function(){hj_tinymce_template(),bd_update({action:"get_uploaded_images"}).then(function(b){1==b.Status&&(a.settings.image_list=a.settings.image_list.concat(b.Values))})}),a.ui.registry.addButton("reset-to-default",{icon:"restore-draft",tooltip:"\u91CD\u7F6E\u70BA\u9810\u8A2D\u683C\u5F0F",onAction:function(){hj_tinymce_template_reset()}})}})}),window.onbeforeunload=function(){return!1})}function hj_tinymce_template(){bd_update({action:"voucher_email_template"}).then(function(b){if(1==b.Status){var a=b.Values;a.subject.length||a.template.length?hj_tinymce_template_rendering(a.subject,a.template):hj_tinymce_template_reset(!0)}})}function hj_tinymce_template_rendering(e,f){var c=hj_template_field("voucher"),d=hj_template_field("voucher-email"),b="https://hearty.gift/"+c+"/"+d,g=hj_template_field("voucher-timer"),a=$("<i>",{html:f});$("textarea[name='subject']").val(e),a.find("[data-voucher]").attr({href:b,"data-voucher":c}),a.find("[data-voucher-link]").attr({href:b,"data-voucher-link":b}),a.find("[data-voucher-email]").attr({"data-voucher-email":d}),a.find("[data-voucher-timer]").replaceWith(hj_timer_dom_convert(g)),a.find("[data-nickname]").text($("header .user").attr("title")||""),a.find("[data-date]").text(new Date().toISOString().split("T")[0].replace(/-/g,"/")),tinymce.activeEditor.setContent(a.html(),{format:"raw"})}function hj_timer_dom_convert(a){return(a=parseInt(a)||0)<Math.floor(new Date().getTime()/1e3)&&(a=0),$("<img>",{src:"https://i.hearty.app/t/"+a,"data-voucher-timer":a,alt:"\u671F\u9650\u5012\u6578",title:"\u671F\u9650\u5012\u6578",width:300,height:75}).css({"border-radius":".5px"})}function hj_tinymce_template_reset(a){a?$.ajax({url:"email.template.html?v="+new Date().toISOString().split("T")[0],dataType:"text",success:function(a){hj_tinymce_template_rendering("\u60A8\u7368\u4EAB\u7684\u300C\u6EAB\u5EA6\u65E5\u8A18 VIP 30\u65E5\u514C\u63DB\u5238\u300D",a)}}):(alertify.set({labels:{ok:"\u53D6\u6D88",cancel:'<i class="fas fa-truck-plow"></i> \u6E05\u6389\u5B83'},buttonReverse:!1}),alertify.confirm('<i class="fal fa-history"></i> \u8981\u6E05\u9664\u5167\u5BB9\uFF0C\u4E26\u56DE\u5230\u9810\u8A2D\u683C\u5F0F\u55CE\uFF1F',function(a){a||hj_tinymce_template_reset(!0)}))}function hj_tinymce_template_save(){var a=tinymce.activeEditor.getContent({format:"raw"})||"";bd_update({action:"voucher_email_template",subject:$("textarea[name='subject']").val(),template:a}).then(function(a){1==a.Status&&alertify.success('<i class="fal fa-save"></i> \u5DF2\u5B58\u70BA\u9810\u8A2D\u7BC4\u672C')})}function hj_template_field(a){return $(".email [data-"+a+"]").attr("data-"+a)}function hj_tinymce_variable(a){tinymce.activeEditor.insertContent(" "+a.prop({contenteditable:!1}).prop("outerHTML")+" ",""),alertify.success('<i class="fal fa-plus"></i> \u63D2\u5165 '+a.attr("title"))}function linkify(a){return(a||"").replace(/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,'<a target="_blank" href="$&">$&</a>').replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a target="_blank" href="https://$2">$2</a>')}function hj_export(){var a=$(".vouchers table").clone();a.find("th[title],td[title]").each(function(){$(this).text($(this).attr("title")||"")}),a.find("[data-link]").remove(),exportTableToCSV(a,($("header .user").attr("title")||"\u6EAB\u5EA6\u5E8F\u865F")+"_"+new Date().toISOString().split("T")[0].replace(/-/g,"")+".csv")}function exportTableToCSV(b,c){var d=b.find("tr:has(th)"),e=b.find("tr:has(td)"),f='"\r\n"',a='"';a+=h(d.map(i)),a+=f,a+=h(e.map(i))+'"';var g="data:application/csv;charset=utf-8,"+encodeURIComponent(a);function h(a){return a.get().join("\0").split("\0").join(f).split("\v").join('","')}function i(d,c){var b=$(c),a=b.find("td");return a.length||(a=b.find("th")),a.map(j).get().join("\v")}function j(b,a){return $(a).text().replace('"','""')}$("<a>",{href:g,download:c}).get(0).click()}function bd_contract(){bd_update({action:"bd_contract"}).then(function(a){(a.Values||"").length>0&&hj_preview(!0,"//drive.google.com/file/d/"+a.Values+"/preview")})}function hj_preview(d,e){var c=$("body"),a=$(".hj_preview"),b=a.find("iframe");d?(b.attr({src:e||b.attr("data-url")||"//docs.google.com/document/d/e/2PACX-1vRmTICp7EIOPI_Lis2JTsVtb5tqoz3wulkTZzh2OUJKrzn_97RSpFmK9NtjXFnW4c5fBK374akpK0f8/pub?embedded=true"}).addClass("loading"),a.fadeIn(),c.css({"overflow-y":"hidden","touch-action":"none"})):(a.fadeOut(),c.css({"overflow-y":"auto","touch-action":"auto"}),b.attr({src:""}))}function generate_tutorial(){if("introJs"in window){var a=$(".vouchers");introJs().setOptions({showBullets:!1,prevLabel:"\u4E0A\u4E00\u6B65",nextLabel:"\u7E7C\u7E8C",doneLabel:"\u6715\u77E5\u9053\u4E86",steps:[{element:a.find("[data-create]").get(0),intro:"\u{1F449}\u3000\u9EDE\u300C\u53D6\u865F\u300D\uFF0C\u7372\u5F97\u5E8F\u865F",position:"left"},{element:a.find("table").get(0),intro:"\u{1F381}\u3000\u5E8F\u865F\u6703\u5217\u65BC\u8868\u4E2D",position:"top"},{element:a.find("table th:nth-child(5)").get(0),intro:"\u2709\uFE0F\u3000\u53EF\u5BC4\u767C\u5E8F\u865F Email",position:"top"},{element:$("#Smallchat iframe").get(0),intro:"\u{1F4AC}\u3000\u5982\u6709\u554F\u984C\uFF0C\u96A8\u6642\u79C1\u8A0A\u6211\u5011",position:"top"}]}).start().oncomplete(function(){hj_preview(!0)}).onexit(function(){hj_preview(!0)}),setcookie("hearty_voucher_tutorial",1,3)}else hj_getScript_npm("intro.js@3.2.1/intro.min.js",generate_tutorial)}function redeem_tutorial(b){var a=$(".redeem_tutorial"),c={1:"\u4E00\u3001\u624B\u52D5\u8F38\u5165\u5E8F\u865F",2:"\u4E8C\u3001\u9EDE\u9078\u514C\u63DB\u9023\u7D50"};if(b){if(a.length>0)a.fadeIn();else{var d=["//i.hearty.app/b/videos/voucher_redeem",check_OS("iOS")?"#t=0.001":""];$("<section>",{class:"redeem_tutorial",html:Object.keys(c).map(function(a){return $("<div>",{title:c[a],html:$("<video>",{controls:"",controlsList:"nodownload noplaybackrate",muted:"",preload:"",disablePictureInPicture:"",html:$("<source>",{src:d[0]+a+".webm"+d[1],type:"video/webm"}).add($("<source>",{src:d[0]+a+".mp4"+d[1],type:"video/mp4"}))}).on("play",function(){this.requestFullscreen&&this.requestFullscreen()}).on("click",function(a){a.stopPropagation()})})})}).on("click",function(){redeem_tutorial(!1)}).appendTo("body")}}else a.fadeOut()}$(function(){$(document).on("click",".vouchers [data-copy]",function(){hj_copy_text(this.title)}).on("click",".vouchers td[data-link]",function(){get_link($(this))}).on("click",".vouchers td[data-email]",function(){collect_email($(this))}).on("click",".vouchers td[data-remark]",function(){voucher_remark($(this))}).on("click",".vouchers td[data-hide]",function(){hide_voucher($(this))}),$(".user").on("click",function(){hj_href("account")}),$("header [data-menu]").on("click",function(){nav_toggle($(".menu"),!0)}),$(".email").on("click",function(){confirm("\u8981\u96E2\u958B\u7DE8\u8F2F\u8996\u7A97\u55CE\uFF1F")&&email_composer(!1)}).children("div").on("click",function(a){a.stopPropagation()}).find("input[type='email']").on("click",function(){hj_copy($(this))}),$(".email .variables").on("click",function(a){a.preventDefault()}).find("a").on("click",function(){$(this).is("[data-voucher-timer]")?hj_tinymce_variable(hj_timer_dom_convert($(this).attr("data-voucher-timer")).add($("<br>"))):hj_tinymce_variable($(this))}),$(".email [data-send]").on("click",send_voucher_email),$(".email [data-sender]").on("click",sender_info).find("address").on("click",function(){hj_copy_text(this.innerText)}),$("[data-export]").on("click",hj_export),$("[data-create]").on("click",create_vouchers),$(".contract").on("click",bd_contract),$(".help_btn").on("click",function(){getcookie("hearty_voucher_tutorial")?hj_preview(!0):generate_tutorial()}),$(".hj_preview").on("click",function(){hj_preview(!1)}).find("iframe").on("load",function(){$(this).removeClass("loading")}),$("[data-shortcut]").on("click",function(){hj_getFile("d.hearty.app/win/BD.exe","\u6EAB\u5EA6\u65E5\u8A18\u5408\u4F5C\u5925\u4F34.exe")}),$("[data-redeem]").on("click",function(){redeem_tutorial(!0)}),$("[data-kit]").on("click",function(){hj_preview(!0,"//docs.google.com/embeddedfolderview?id=0B27GP5aLuObncVg1enJRcFlsSHM#grid")}),$("[data-tm]").on("click",function(){hj_preview(!0,"//mozilla.github.io/pdf.js/web/viewer.html?file=//cdn.jsdelivr.net/gh/chennien/d.hearty.app@1/docs/trademarks.pdf"),check_OS("Windows")&&hj_getFile("d.hearty.app/win/trademarks.exe","\u6EAB\u5EA6\u65E5\u8A18\u5546\u6A19.exe")}),$("[data-notavailable]").on("click",function(){msg('<i class="fal fa-box-full"></i> \u529F\u80FD\u5373\u5C07\u63A8\u51FA\uFF0C\u597D\u4E86\u518D\u8B93\u4F60\u77E5\u9053')}),get_vouchers(),$(".toast_signin_reminder").delay(5e3).queue(function(){$(this).fadeOut().dequeue()}),hj_localize_cn()})